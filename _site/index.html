<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>3行代码</title>
    <meta name="description" content="">

    <link rel="shortcut icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="icon" href="/favicon.ico?" type="image/x-icon">
    <link rel="stylesheet" href="/css/fontawesome/css/font-awesome.min.css ">
    <link rel="stylesheet" href="/css/main.css ">
    <link rel="canonical" href="http://localhost:4000/">
    <link rel="alternate" type="application/rss+xml" title="3行代码" href="http://localhost:4000/feed.xml ">


<script>
    // 百度统计代码
    var _hmt = _hmt || [];
    (function() {
     var hm = document.createElement("script");
     hm.src = "//hm.baidu.com/hm.js?d9432112fb859bf7276f8399641fb0c5";
     var s = document.getElementsByTagName("script")[0];
     s.parentNode.insertBefore(hm, s);
     })();
    </script>




    <script>
    // google analytics
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-85978943-1', 'auto');
      ga('send', 'pageview');

    </script>

</head>


  <body>

    <header id="top">
    <div class="wrapper">
        <a href="/" class="brand">3行代码</a>
        <small>技术博客</small>
        <button id="headerMenu" class="menu"><i class="fa fa-bars"></i></button>
        <nav id="headerNav">
            <ul>
                
                <li>
                    
                    <a class="active" href="/">
                        
                        <i class="fa fa-home"></i>Home
                    </a>
                </li>


                
                    
                    <li>
                        
                        <a href="/archive/">
                        
                            <i class="fa fa-archive"></i>Archives
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/category/">
                        
                            <i class="fa fa-th-list"></i>Categories
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/tag/">
                        
                            <i class="fa fa-tags"></i>Tags
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/collection/">
                        
                            <i class="fa fa-bookmark"></i>Collections
                        </a>
                    </li>
                    
                
                    
                    <li>
                        
                        <a href="/about/">
                        
                            <i class="fa fa-heart"></i>About
                        </a>
                    </li>
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
                    
                
            </ul>
        </nav>
    </div>
</header>


        <div class="page clearfix" index>
    <div class="left">
        <h1>Welcome to 3code.info!</h1>
        <small>记录生活</small>
        <hr>
        <ul>
            
              <li>
                <h2>
                  <a class="post-link" href="/2017/02/08/AD-jenkins/"> 持续集成系列 - CI + Jenkins的魔法世界</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2017-02-08
                    </div>
                    <div class="label-card">
                        <i class="fa fa-user"></i>3行代码
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#CI" title="Category: CI" rel="category">CI</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#fastlane" title="Tag: fastlane" rel="tag">fastlane</a>&nbsp;
    
        <a href="/tag/#CI" title="Tag: CI" rel="tag">CI</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#ci-" id="markdown-toc-ci-">CI 基础知识</a>    <ul>
      <li><a href="#continuous-integration" id="markdown-toc-continuous-integration">持续集成(Continuous Integration)</a></li>
      <li><a href="#continuous-deployment" id="markdown-toc-continuous-deployment">持续部署(Continuous Deployment)</a></li>
    </ul>
  </li>
</ul>

<blockquote>

  <p>最近一直在关注移动端的持续集成部署相关的内容,在网搜 Jenkins 资料是很多,但是基本都不是移动端的集成部署.下边将个人的使用体会分享出来,希望能帮助到需要的伙伴们.</p>

</blockquote>

<p><strong>在进行 CI 之前,你需要一些基本的知识</strong></p>

<h3 id="ci-">CI 基础知识</h3>

<p>在互联网的产品开发时代,产品迭代越来越频繁,“从功能开发完成直到成功部署”这一阶段被称为软件开发“最后一公里”.很多开发团队也越来越认识到,自动化测试和持续部署可帮助开发团队提高迭代效率和质量.
那么,如何更好地解决“最后一公里”这一问题呢?</p>

<p>可以分为两部分:持续集成和持续部署</p>
<ul>
  <li>持续集成:是指整个开发过程,每个人开发的模块向项目主体交付时,频繁进行集成以便更快地发现其中的错误</li>
  <li>持续部署:是指开发过程中连续的阶段性版本的上线, V1.1.0上线部署,V1.1.1上线部署…</li>
  <li>前者和后者时间尺度是一样的,不过前者是涵盖每一次 push ,后者是指一个稳定的版本,可以内测和发布用的</li>
  <li>实际使用中,两者是结合在一起的,持续集成的平台上,可以进一步配置持续部署,这样就可以实现:每次 push 自动构建测试,每次稳定的版本,可以顺利的构建分发用于内测.</li>
</ul>

<h5 id="continuous-integration">持续集成(Continuous Integration)</h5>

<p>持续集成:是指整个开发过程,个人开发的模块,向项目主体交付,频繁进行集成以便更快地发现其中的错误.涉及到的内容为:</p>

<ul>
  <li>自动化测试:单元测试+ UI 测试</li>
  <li>持续集成平台:Jenkins (自动化的构建) \ Travis CI (基于 github 平台的CI持续集成)等</li>
  <li>版本控制:如 Git\SVN\CVS 等</li>
  <li>部署发布工具:fastlane 等</li>
  <li>部署发布平台:蒲公英\Fir.im (目前支持 Android 和 iOS 应用的分发,提供的工具有 flow.ci)</li>
  <li>一般流程(Jenkins 为例):Jenkins 服务器轮训 Git ,发现新的版本,就会 clone 到本地,并按照预先设定的脚本进行自动编译,并执行测试.如果有问题,就会发出邮件通知.</li>
</ul>

<h5 id="continuous-deployment">持续部署(Continuous Deployment)</h5>

<p>持续部署:是指开发过程中的连续的阶段性版本, V1.1.0上线部署,V1.1.1上线部署…
在移动端主要是使用 fastlane 实现持续部署:</p>

<ul>
  <li>开发项目,单元测试</li>
  <li>模块开发,集成\UI 测试</li>
  <li>Archive项目</li>
  <li>上传包到iTunes</li>
  <li>在iTunes后台提交版本截图\描述等信息(也可以在测试完成后配置)</li>
  <li>配置TestFlight,分发测试Beta版</li>
  <li>测试,改 bug</li>
  <li>测试完成,提交App Store审核</li>
</ul>


                </div>
                <div class="read-all">
                    <a  href="/2017/02/08/AD-jenkins/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2017/02/08/AD-jenkins/">Ad Jenkins</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2017-02-08
                    </div>
                    <div class="label-card">
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    



                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <!DOCTYPE html><html><head><meta charset="utf-8"><meta name="layout" content="post">
<meta name="tags" content="fastlane CI">
<meta name="categories" content="CI">
<meta name="author" content="3行代码"><style>body {
  width: 45em;
  border: 1px solid #ddd;
  outline: 1300px solid #fff;
  margin: 16px auto;
}

body .markdown-body
{
  padding: 30px;
}

@font-face {
  font-family: fontawesome-mini;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

@font-face {
  font-family: octicons-anchor;
  src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}

.markdown-body {
  font-family: sans-serif;
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #333333;
  overflow: hidden;
  font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
  font-size: 16px;
  line-height: 1.6;
  word-wrap: break-word;
}

.markdown-body a {
  background: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline: 0;
}

.markdown-body b,
.markdown-body strong {
  font-weight: bold;
}

.markdown-body mark {
  background: #ff0;
  color: #000;
  font-style: italic;
  font-weight: bold;
}

.markdown-body sub,
.markdown-body sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
.markdown-body sup {
  top: -0.5em;
}
.markdown-body sub {
  bottom: -0.25em;
}

.markdown-body h1 {
  font-size: 2em;
  margin: 0.67em 0;
}

.markdown-body img {
  border: 0;
}

.markdown-body hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}

.markdown-body pre {
  overflow: auto;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre,
.markdown-body samp {
  font-family: monospace, monospace;
  font-size: 1em;
}

.markdown-body input {
  color: inherit;
  font: inherit;
  margin: 0;
}

.markdown-body html input[disabled] {
  cursor: default;
}

.markdown-body input {
  line-height: normal;
}

.markdown-body input[type="checkbox"] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body .codehilitetable {
  border: 0;
  border-spacing: 0;
}

.markdown-body .codehilitetable tr {
  border: 0;
}

.markdown-body .codehilitetable pre,
.markdown-body .codehilitetable div.codehilite {
  margin: 0;
}

.markdown-body .linenos,
.markdown-body .code,
.markdown-body .codehilitetable td {
  border: 0;
  padding: 0;
}

.markdown-body td:not(.linenos) .linenodiv {
  padding: 0 !important;
}

.markdown-body .code {
  width: 100%;
}

.markdown-body .linenos div pre,
.markdown-body .linenodiv pre,
.markdown-body .linenodiv {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-left-radius: 3px;
  -webkit-border-bottom-left-radius: 3px;
  -moz-border-radius-topleft: 3px;
  -moz-border-radius-bottomleft: 3px;
  border-top-left-radius: 3px;
  border-bottom-left-radius: 3px;
}

.markdown-body .code div pre,
.markdown-body .code div {
  border: 0;
  -webkit-border-radius: 0;
  -moz-border-radius: 0;
  border-radius: 0;
  -webkit-border-top-right-radius: 3px;
  -webkit-border-bottom-right-radius: 3px;
  -moz-border-radius-topright: 3px;
  -moz-border-radius-bottomright: 3px;
  border-top-right-radius: 3px;
  border-bottom-right-radius: 3px;
}

.markdown-body * {
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body input {
  font: 13px Helvetica, arial, freesans, clean, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol";
  line-height: 1.4;
}

.markdown-body a {
  color: #4183c4;
  text-decoration: none;
}

.markdown-body a:hover,
.markdown-body a:focus,
.markdown-body a:active {
  text-decoration: underline;
}

.markdown-body hr {
  height: 0;
  margin: 15px 0;
  overflow: hidden;
  background: transparent;
  border: 0;
  border-bottom: 1px solid #ddd;
}

.markdown-body hr:before,
.markdown-body hr:after {
  display: table;
  content: " ";
}

.markdown-body hr:after {
  clear: both;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-top: 15px;
  margin-bottom: 15px;
  line-height: 1.1;
}

.markdown-body h1 {
  font-size: 30px;
}

.markdown-body h2 {
  font-size: 21px;
}

.markdown-body h3 {
  font-size: 16px;
}

.markdown-body h4 {
  font-size: 14px;
}

.markdown-body h5 {
  font-size: 12px;
}

.markdown-body h6 {
  font-size: 11px;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ul,
.markdown-body ol {
  padding: 0;
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ul ul ol,
.markdown-body ul ol ol,
.markdown-body ol ul ol,
.markdown-body ol ol ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre,
.markdown-body samp {
  font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #e7e7e7;
  background-image: -moz-linear-gradient(#fefefe, #e7e7e7);
  background-image: -webkit-linear-gradient(#fefefe, #e7e7e7);
  background-image: linear-gradient(#fefefe, #e7e7e7);
  background-repeat: repeat-x;
  border-radius: 2px;
  border: 1px solid #cfcfcf;
  color: #000;
  padding: 3px 5px;
  line-height: 10px;
  font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
  display: inline-block;
}

.markdown-body>*:first-child {
  margin-top: 0 !important;
}

.markdown-body>*:last-child {
  margin-bottom: 0 !important;
}

.markdown-body .headeranchor-link {
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  display: block;
  padding-right: 6px;
  padding-left: 30px;
  margin-left: -30px;
}

.markdown-body .headeranchor-link:focus {
  outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  position: relative;
  margin-top: 1em;
  margin-bottom: 16px;
  font-weight: bold;
  line-height: 1.4;
}

.markdown-body h1 .headeranchor,
.markdown-body h2 .headeranchor,
.markdown-body h3 .headeranchor,
.markdown-body h4 .headeranchor,
.markdown-body h5 .headeranchor,
.markdown-body h6 .headeranchor {
  display: none;
  color: #000;
  vertical-align: middle;
}

.markdown-body h1:hover .headeranchor-link,
.markdown-body h2:hover .headeranchor-link,
.markdown-body h3:hover .headeranchor-link,
.markdown-body h4:hover .headeranchor-link,
.markdown-body h5:hover .headeranchor-link,
.markdown-body h6:hover .headeranchor-link {
  height: 1em;
  padding-left: 8px;
  margin-left: -30px;
  line-height: 1;
  text-decoration: none;
}

.markdown-body h1:hover .headeranchor-link .headeranchor,
.markdown-body h2:hover .headeranchor-link .headeranchor,
.markdown-body h3:hover .headeranchor-link .headeranchor,
.markdown-body h4:hover .headeranchor-link .headeranchor,
.markdown-body h5:hover .headeranchor-link .headeranchor,
.markdown-body h6:hover .headeranchor-link .headeranchor {
  display: inline-block;
}

.markdown-body h1 {
  padding-bottom: 0.3em;
  font-size: 2.25em;
  line-height: 1.2;
  border-bottom: 1px solid #eee;
}

.markdown-body h2 {
  padding-bottom: 0.3em;
  font-size: 1.75em;
  line-height: 1.225;
  border-bottom: 1px solid #eee;
}

.markdown-body h3 {
  font-size: 1.5em;
  line-height: 1.43;
}

.markdown-body h4 {
  font-size: 1.25em;
}

.markdown-body h5 {
  font-size: 1em;
}

.markdown-body h6 {
  font-size: 1em;
  color: #777;
}

.markdown-body p,
.markdown-body blockquote,
.markdown-body ul,
.markdown-body ol,
.markdown-body dl,
.markdown-body table,
.markdown-body pre,
.markdown-body .admonition {
  margin-top: 0;
  margin-bottom: 16px;
}

.markdown-body hr {
  height: 4px;
  padding: 0;
  margin: 16px 0;
  background-color: #e7e7e7;
  border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
  padding-left: 2em;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
  margin-top: 0;
  margin-bottom: 0;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  padding: 0;
  margin-top: 16px;
  font-size: 1em;
  font-style: italic;
  font-weight: bold;
}

.markdown-body dl dd {
  padding: 0 16px;
  margin-bottom: 16px;
}

.markdown-body blockquote {
  padding: 0 15px;
  color: #777;
  border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body table {
  display: block;
  width: 100%;
  overflow: auto;
  word-break: normal;
  word-break: keep-all;
}

.markdown-body table th {
  font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
  padding: 6px 13px;
  border: 1px solid #ddd;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

.markdown-body img {
  max-width: 100%;
  -moz-box-sizing: border-box;
  box-sizing: border-box;
}

.markdown-body code,
.markdown-body samp {
  padding: 0;
  padding-top: 0.2em;
  padding-bottom: 0.2em;
  margin: 0;
  font-size: 85%;
  background-color: rgba(0,0,0,0.04);
  border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after {
  letter-spacing: -0.2em;
  content: "\00a0";
}

.markdown-body pre>code {
  padding: 0;
  margin: 0;
  font-size: 100%;
  word-break: normal;
  white-space: pre;
  background: transparent;
  border: 0;
}

.markdown-body .codehilite {
  margin-bottom: 16px;
}

.markdown-body .codehilite pre,
.markdown-body pre {
  padding: 16px;
  overflow: auto;
  font-size: 85%;
  line-height: 1.45;
  background-color: #f7f7f7;
  border-radius: 3px;
}

.markdown-body .codehilite pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre code {
  display: inline;
  max-width: initial;
  padding: 0;
  margin: 0;
  overflow: initial;
  line-height: inherit;
  word-wrap: normal;
  background-color: transparent;
  border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after {
  content: normal;
}

/* Admonition */
.markdown-body .admonition {
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  position: relative;
  border-radius: 3px;
  border: 1px solid #e0e0e0;
  border-left: 6px solid #333;
  padding: 10px 10px 10px 30px;
}

.markdown-body .admonition table {
  color: #333;
}

.markdown-body .admonition p {
  padding: 0;
}

.markdown-body .admonition-title {
  font-weight: bold;
  margin: 0;
}

.markdown-body .admonition>.admonition-title {
  color: #333;
}

.markdown-body .attention>.admonition-title {
  color: #a6d796;
}

.markdown-body .caution>.admonition-title {
  color: #d7a796;
}

.markdown-body .hint>.admonition-title {
  color: #96c6d7;
}

.markdown-body .danger>.admonition-title {
  color: #c25f77;
}

.markdown-body .question>.admonition-title {
  color: #96a6d7;
}

.markdown-body .note>.admonition-title {
  color: #d7c896;
}

.markdown-body .admonition:before,
.markdown-body .attention:before,
.markdown-body .caution:before,
.markdown-body .hint:before,
.markdown-body .danger:before,
.markdown-body .question:before,
.markdown-body .note:before {
  font: normal normal 16px fontawesome-mini;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  line-height: 1.5;
  color: #333;
  position: absolute;
  left: 0;
  top: 0;
  padding-top: 10px;
  padding-left: 10px;
}

.markdown-body .admonition:before {
  content: "\f056\00a0";
  color: 333;
}

.markdown-body .attention:before {
  content: "\f058\00a0";
  color: #a6d796;
}

.markdown-body .caution:before {
  content: "\f06a\00a0";
  color: #d7a796;
}

.markdown-body .hint:before {
  content: "\f05a\00a0";
  color: #96c6d7;
}

.markdown-body .danger:before {
  content: "\f057\00a0";
  color: #c25f77;
}

.markdown-body .question:before {
  content: "\f059\00a0";
  color: #96a6d7;
}

.markdown-body .note:before {
  content: "\f040\00a0";
  color: #d7c896;
}

.markdown-body .admonition::after {
  content: normal;
}

.markdown-body .attention {
  border-left: 6px solid #a6d796;
}

.markdown-body .caution {
  border-left: 6px solid #d7a796;
}

.markdown-body .hint {
  border-left: 6px solid #96c6d7;
}

.markdown-body .danger {
  border-left: 6px solid #c25f77;
}

.markdown-body .question {
  border-left: 6px solid #96a6d7;
}

.markdown-body .note {
  border-left: 6px solid #d7c896;
}

.markdown-body .admonition>*:first-child {
  margin-top: 0 !important;
}

.markdown-body .admonition>*:last-child {
  margin-bottom: 0 !important;
}

/* progress bar*/
.markdown-body .progress {
  display: block;
  width: 300px;
  margin: 10px 0;
  height: 24px;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #ededed;
  position: relative;
  box-shadow: inset -1px 1px 3px rgba(0, 0, 0, .1);
}

.markdown-body .progress-label {
  position: absolute;
  text-align: center;
  font-weight: bold;
  width: 100%; margin: 0;
  line-height: 24px;
  color: #333;
  text-shadow: 1px 1px 0 #fefefe, -1px -1px 0 #fefefe, -1px 1px 0 #fefefe, 1px -1px 0 #fefefe, 0 1px 0 #fefefe, 0 -1px 0 #fefefe, 1px 0 0 #fefefe, -1px 0 0 #fefefe, 1px 1px 2px #000;
  -webkit-font-smoothing: antialiased !important;
  white-space: nowrap;
  overflow: hidden;
}

.markdown-body .progress-bar {
  height: 24px;
  float: left;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
  background-color: #96c6d7;
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, .5), inset 0 -1px 0 rgba(0, 0, 0, .1);
  background-size: 30px 30px;
  background-image: -webkit-linear-gradient(
    135deg, rgba(255, 255, 255, .4) 27%,
    transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%,
    transparent 77%, transparent
  );
  background-image: -moz-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -ms-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: -o-linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
  background-image: linear-gradient(
    135deg,
    rgba(255, 255, 255, .4) 27%, transparent 27%,
    transparent 52%, rgba(255, 255, 255, .4) 52%,
    rgba(255, 255, 255, .4) 77%, transparent 77%,
    transparent
  );
}

.markdown-body .progress-100plus .progress-bar {
  background-color: #a6d796;
}

.markdown-body .progress-80plus .progress-bar {
  background-color: #c6d796;
}

.markdown-body .progress-60plus .progress-bar {
  background-color: #d7c896;
}

.markdown-body .progress-40plus .progress-bar {
  background-color: #d7a796;
}

.markdown-body .progress-20plus .progress-bar {
  background-color: #d796a6;
}

.markdown-body .progress-0plus .progress-bar {
  background-color: #c25f77;
}

.markdown-body .candystripe-animate .progress-bar{
  -webkit-animation: animate-stripes 3s linear infinite;
  -moz-animation: animate-stripes 3s linear infinite;
  animation: animate-stripes 3s linear infinite;
}

@-webkit-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@-moz-keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

@keyframes animate-stripes {
  0% {
    background-position: 0 0;
  }

  100% {
    background-position: 60px 0;
  }
}

.markdown-body .gloss .progress-bar {
  box-shadow:
    inset 0 4px 12px rgba(255, 255, 255, .7),
    inset 0 -12px 0 rgba(0, 0, 0, .05);
}

/* Multimarkdown Critic Blocks */
.markdown-body .critic_mark {
  background: #ff0;
}

.markdown-body .critic_delete {
  color: #c82829;
  text-decoration: line-through;
}

.markdown-body .critic_insert {
  color: #718c00 ;
  text-decoration: underline;
}

.markdown-body .critic_comment {
  color: #8e908c;
  font-style: italic;
}

.markdown-body .headeranchor {
  font: normal normal 16px octicons-anchor;
  line-height: 1;
  display: inline-block;
  text-decoration: none;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
}

.headeranchor:before {
  content: '\f05c';
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 4px 0.25em -20px;
  vertical-align: middle;
}

/* Media */
@media only screen and (min-width: 480px) {
  .markdown-body {
    font-size:14px;
  }
}

@media only screen and (min-width: 768px) {
  .markdown-body {
    font-size:16px;
  }
}

@media print {
  .markdown-body * {
    background: transparent !important;
    color: black !important;
    filter:none !important;
    -ms-filter: none !important;
  }

  .markdown-body {
    font-size:12pt;
    max-width:100%;
    outline:none;
    border: 0;
  }

  .markdown-body a,
  .markdown-body a:visited {
    text-decoration: underline;
  }

  .markdown-body .headeranchor-link {
    display: none;
  }

  .markdown-body a[href]:after {
    content: " (" attr(href) ")";
  }

  .markdown-body abbr[title]:after {
    content: " (" attr(title) ")";
  }

  .markdown-body .ir a:after,
  .markdown-body a[href^="javascript:"]:after,
  .markdown-body a[href^="#"]:after {
    content: "";
  }

  .markdown-body pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  .markdown-body pre,
  .markdown-body blockquote {
    border: 1px solid #999;
    padding-right: 1em;
    page-break-inside: avoid;
  }

  .markdown-body .progress,
  .markdown-body .progress-bar {
    -moz-box-shadow: none;
    -webkit-box-shadow: none;
    box-shadow: none;
  }

  .markdown-body .progress {
    border: 1px solid #ddd;
  }

  .markdown-body .progress-bar {
    height: 22px;
    border-right: 1px solid #ddd;
  }

  .markdown-body tr,
  .markdown-body img {
    page-break-inside: avoid;
  }

  .markdown-body img {
    max-width: 100% !important;
  }

  .markdown-body p,
  .markdown-body h2,
  .markdown-body h3 {
    orphans: 3;
    widows: 3;
  }

  .markdown-body h2,
  .markdown-body h3 {
    page-break-after: avoid;
  }
}
</style><title>" 持续集成系列 - CI + Jenkins的魔法世界"</title></head><body><article class="markdown-body"><ul>
<li toc="toc">content<br /></li>
</ul>
<blockquote>
<p>最近一直在关注移动端的持续集成部署相关的内容,在网搜 Jenkins 资料是很多,但是基本都不是移动端的集成部署.下边将个人的使用体会分享出来,希望能帮助到需要的伙伴们.<br />
</p>
</blockquote>
<p><strong>在进行 CI 之前,你需要一些基本的知识</strong></p>
<h3 id="ci"><a name="user-content-ci" href="#ci" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>CI 基础知识</h3>
<p>在互联网的产品开发时代,产品迭代越来越频繁,“从功能开发完成直到成功部署”这一阶段被称为软件开发“最后一公里”.很多开发团队也越来越认识到,自动化测试和持续部署可帮助开发团队提高迭代效率和质量.<br />
那么,如何更好地解决“最后一公里”这一问题呢?</p>
<p>可以分为两部分:持续集成和持续部署<br />
- 持续集成:是指整个开发过程,每个人开发的模块向项目主体交付时,频繁进行集成以便更快地发现其中的错误<br />
- 持续部署:是指开发过程中连续的阶段性版本的上线, V1.1.0上线部署,V1.1.1上线部署&hellip;<br />
- 前者和后者时间尺度是一样的,不过前者是涵盖每一次 push ,后者是指一个稳定的版本,可以内测和发布用的<br />
- 实际使用中,两者是结合在一起的,持续集成的平台上,可以进一步配置持续部署,这样就可以实现:每次 push 自动构建测试,每次稳定的版本,可以顺利的构建分发用于内测.</p>
<h5 id="continuous-integration"><a name="user-content-continuous-integration" href="#continuous-integration" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>持续集成(Continuous Integration)</h5>
<p>持续集成:是指整个开发过程,个人开发的模块,向项目主体交付,频繁进行集成以便更快地发现其中的错误.涉及到的内容为:</p>
<ul>
<li>自动化测试:单元测试+ UI 测试</li>
<li>持续集成平台:Jenkins (自动化的构建) \ Travis CI (基于 github 平台的CI持续集成)等</li>
<li>版本控制:如 Git\SVN\CVS 等</li>
<li>部署发布工具:fastlane 等</li>
<li>部署发布平台:蒲公英\Fir.im (目前支持 Android 和 iOS 应用的分发,提供的工具有 flow.ci)</li>
<li>一般流程(Jenkins 为例):Jenkins 服务器轮训 Git ,发现新的版本,就会 clone 到本地,并按照预先设定的脚本进行自动编译,并执行测试.如果有问题,就会发出邮件通知.</li>
</ul>
<h5 id="continuous-deployment"><a name="user-content-continuous-deployment" href="#continuous-deployment" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>持续部署(Continuous Deployment)</h5>
<p>持续部署:是指开发过程中的连续的阶段性版本, V1.1.0上线部署,V1.1.1上线部署&hellip;<br />
在移动端主要是使用 fastlane 实现持续部署:</p>
<ul>
<li>开发项目,单元测试</li>
<li>模块开发,集成\UI 测试</li>
<li>Archive项目</li>
<li>上传包到iTunes</li>
<li>在iTunes后台提交版本截图\描述等信息(也可以在测试完成后配置)</li>
<li>配置TestFlight,分发测试Beta版</li>
<li>测试,改 bug</li>
<li>测试完成,提交App Store审核</li>
</ul>
<h5 id="1-xcode-xcodebuild"><a name="user-content-1-xcode-xcodebuild" href="#1-xcode-xcodebuild" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>1.  Xcode 命令行工具 : xcodebuild</h5>
<p>Xcode 不仅可以通过 GUI 编译运行,还可以通过命令行实现编译运行,这也是 CI 的基础条件之一.</p>
<p>官方的使用方法:</p>
<pre><code class="shell">xcodebuild [-project &lt;projectname&gt;] [[-target &lt;targetname&gt;]...|-alltargets] [-configuration &lt;configurationname&gt;] [-arch &lt;architecture&gt;]... [-sdk [&lt;sdkname&gt;|&lt;sdkpath&gt;]] [-showBuildSettings] [&lt;buildsetting&gt;=&lt;value&gt;]... [&lt;buildaction&gt;]...

...
</code></pre>

<p>关键字:<br />
<pre><code>Options:
    -usage                              print brief usage
    -help                               print complete usage
    -verbose                            provide additional status output
    -license                            show the Xcode and SDK license agreements
    ....
</code></pre></p>
<p><strong>实战:</strong><br />
<pre><code>$ cd  /Users/guoyinjinrong1/Git_Projecrt/XCTest/UITEST 
$ xcodebuild build -workspace UITEST.xcworkspace -scheme UITEST -sdk iphonesimulator ONLY_ACTIVE_ARCH=NO
</code></pre></p>
<h5 id="2-project"><a name="user-content-2-project" href="#2-project" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>2. project 项目的命令行编译:</h5>
<pre><code class="shell"># 列出 xcodebuild 所有可用的参数:
$ xcodebuild --help
# project 项目的命令行编译:
$ xcodebuild -project {project}.xcodeproj -target {xxtarget} -sdk iphonesimulator ONLY_ACTIVE_ARCH=NO
#
</code></pre>

<p>使用 iphonesimulator SDK 是为了避免签名错误.直到我们稍后引入证书之前,这一步是必须的.通过设置 ONLY_ACTIVE_ARCH=NO 我们可以确保利用模拟器架构编译工程.你也可以设置额外的属性,例如 configuration,输入 man xcodebuild 查看相关文档.</p>
<h5 id="3cocoapods"><a name="user-content-3cocoapods" href="#3cocoapods" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>3.CocoaPods 项目</h5>
<pre><code class="shell"># 需要用下面的命令来指定 workspace 和 scheme：
$ xcodebuild -workspace {workspace}.xcworkspace -scheme {scheme} -sdk iphonesimulator ONLY_ACTIVE_ARCH=NO
</code></pre>

<p>schemes 是由 Xcode 自动生成的,但这在服务器上不会发生.确保所有的 scheme 都被设为 shared 并加入到仓库中.否则它只会在本地工作而不会被  CI 系统识别</p>
<h5 id="4xctool"><a name="user-content-4xctool" href="#4xctool" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>4.Xctool</h5>
<p>Xctool 是来自 Facebook 的命令行工具,它可以简化程序的编译和测试.它的彩色输出信息比 xcodebuild 更加简洁直观.同时还添加了对逻辑测试,应用测试的支持.(Travis 中已经预装了 xctool.要在本地测试的话,需要用 Homebrew 安装 xctool)</p>
<p>xctool 用法非常简单,它使用的参数跟 xcodebuild 相同:<br />
<pre><code class="shell">xctool test -workspace TravisExample.xcworkspace -scheme TravisExampleTests -sdk iphonesimulator ONLY_ACTIVE_ARCH=NO
</code></pre></p>
<h3 id="jenkins"><a name="user-content-jenkins" href="#jenkins" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Jenkins 简介</h3>
<p>1.简介:</p>
<ul>
<li>Jenkins 由以前的 hudson 更名而来</li>
<li>Jenkins 是一个跨平台的开源软件项目,旨在实现持续集成和持续交付以提高工作效率</li>
<li>Jenkins 的主要功能是监视重复工作的执行,例如项目的构建等</li>
<li>最终都是为了提高软件开发的效率</li>
</ul>
<p>2.特点:</p>
<ul>
<li>易于安装:一个命令就可启动,也方便部署到各种Web容器中（如tomcat)</li>
<li>易于配置:所有的配置都在Web界面实现,权限控制得也不错</li>
<li>插件支持:基本上所有的扩展都是有插件完成的,开发插件也很方便,由此产生了庞大的社区</li>
<li>支持分布式构建:Jenkins能够让通过主从模式（master/slave）多台机器一起构建</li>
<li>采用 shell 自定义脚本,控制集成部署环境更加方便灵活</li>
<li>构建失败发邮件通知相关人员解决</li>
<li>自动按天备份 war 包,Jenkins 配置备份以及版本控制化</li>
</ul>
<p>3.公司的配置流程:</p>
<p>1\Jenkins服务器一般先架设在一台服务器上,有配置管理人员管理<br />
2\产品有构建需求后,配置管理人员就新建一个任务,配好源码仓库,设置构建时间,指定运行脚本来编译测试产品,并且设置报告输出</p>
<p>4.弊端:</p>
<ul>
<li>多平台或依赖的包:<br />
如果你的软件想在不同的操作系统软件构建并验​​证,这将是相当有难度和技巧性,一般是准备不同的操作系统的机器,然后使用主/从模式进行分布式构建.在C++中你可以使用有关的交叉编译器;当然你可有使用虚拟机的技术<a href="http://larrycai.github.com/2011/10/25/vagrant-jenkins-ci.html">vagrant/virtualbox</a></li>
<li>配置管理人员的工作:<br />
一般来说Jenkins的构建任务,它是集中控制的.大多来说都是有专职的配置管理人员来管理,否者权限会混乱.<br />
当有需求时,他们负责在CI服务器创建任务（这些配置文件不是有版本控制的）,这个就涉及到了沟通成本,你有变化需求,很难及时满足.</li>
</ul>
<p>作为开发者,要想随时构建项目,那就需要 Travis CI.</p>
<h3 id="jenkins_1"><a name="user-content-jenkins_1" href="#jenkins_1" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>安装 Jenkins</h3>
<h5 id="1"><a name="user-content-1" href="#1" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>1. 安装</h5>
<p>安装方式一:下载<a href="https://mirrors.tuna.tsinghua.edu.cn/jenkins/osx/jenkins-2.45.pkg">pkg</a>文件,然后安装即可(此处未必是最新版,请移步<a href="https://jenkins.io/">官网</a>下载)</p>
<p>安装方式二:终端</p>
<pre><code class="shell"># 安装自动选择最快源的插件
$ yum install yum-fastestmirror -y  
# 添加 Jenkins 源:
$ sudo wget -O /etc/yum.repos.d/jenkins.repo http://jenkins-ci.org/redhat/jenkins.repo
$ sudo rpm --import http://pkg.jenkins-ci.org/redhat/jenkins-ci.org.key
#安装 Jenkins
$ yum install jenkins               
</code></pre>

<h5 id="2"><a name="user-content-2" href="#2" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>2. 启动</h5>
<pre><code class="shell">$ sudo service jenkins start
</code></pre>

<h5 id="3"><a name="user-content-3" href="#3" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>3. 访问方式</h5>
<pre><code class="shell">$ open http://localhost:8080/
</code></pre>

<h5 id="4"><a name="user-content-4" href="#4" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>4. 修改端口</h5>
<p>为避免端口冲突,可重配端口:</p>
<pre><code class="shell">$ vim /etc/sysconfig/jenkins
$ sudo service jenkins restart
</code></pre>

<p>或者这样修改端口:</p>
<pre><code class="shell">sudo launchctl unload /Library/LaunchDaemons/org.jenkins-ci.plist
sudo defaults write /Library/Preferences/org.jenkins-ci httpPort 8443
sudo launchctl load /Library/LaunchDaemons/org.jenkins-ci.plist
# 如果是 https:
sudo defaults write /Library/Preferences/org.jenkins-ci httpPort 8443
sudo defaults write /Library/Preferences/org.jenkins-ci httpsKeyStore /path/to/your/keystore/file
sudo defaults write /Library/Preferences/org.jenkins-ci httpsKeyStorePassword &lt;keystore password&gt;
# 其中两条命令分别是启动和关闭 Jenkins
</code></pre>

<h5 id="5"><a name="user-content-5" href="#5" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>5. 用户设置</h5>
<ul>
<li>
<p>打开页面: <a href="http://localhost:8080">http://localhost:8080</a> , 按照提示从<code>/Users/Shared/Jenkins/Home/secrets/initialAdminPassword</code>文件中获取密码,然后输入即可. <strong>vim 打开文件或者 cat 显示文件皆可</strong></p>
</li>
<li>
<p>然后进入插件设置页面,可以选择 Jenkins 推荐的插件,也可自主选择需要安装的插件.(会有一些插件安装失败,没关系,可以后续再安装)</p>
</li>
<li>
<p>安装完成之后,进入创建用户页面,设置用户名密码等</p>
</li>
<li>
<p>用户创建完成,就可以开始创建第一个 Jenkins 任务啦!</p>
</li>
</ul>
<p>主界面如下(已经创建过一个任务):</p>
<p><img alt="" src="http://img.hb.aicdn.com/0b2dc9f4695effe8bd26d856957165a040f4c3c310b35-pnIrgy_fw658" /></p>
<h5 id="6"><a name="user-content-6" href="#6" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>6.系统设置</h5>
<ol>
<li>编码设置:</li>
</ol>
<blockquote>
<p>进入 系统管理-&gt;系统设置 界面：</p>
</blockquote>
<p>首先设置一下 jenkins 内部shell 执行编码，目的当在jenkins执行shell命令时，有时候会报 utf-8 编码错误。主要是pod install的时候报错。</p>
<p>[33mWARNING: CocoaPods requires your terminal to be using UTF-8 encoding.</p>
<p>设置如下：</p>
<p><img alt="" src="http://img.hb.aicdn.com/cb6bfa7ef1bc54947df56afd938f66f13617e97b220ed-hPTfFv_fw658" /></p>
<p>2.邮件设置:</p>
<p>jenkins Location 设置<br />
主要设置 jenkins 外部访问的 URL 和系统管理员的邮箱地址.用来发送错误报告的邮箱地址：如图<br />
<img alt="" src="http://7xsugd.com2.z0.glb.clouddn.com/runningyoungBlog/images/location.png" /></p>
<p>上面只设置了邮箱发送的地址（From地址）,下面设置邮箱的服务器\协议\邮箱\密码.如图:</p>
<p><img alt="" src="http://7xsugd.com2.z0.glb.clouddn.com/runningyoungBlog/images/email.png" /></p>
<h5 id="7"><a name="user-content-7" href="#7" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>7. 认证配置</h5>
<h2 id="-gitlab-git"><a name="user-content--gitlab-git" href="#-gitlab-git" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>- 基于 用户名+密码 : 将 Gitlab 的用户名,密码添加进来.就可以通过此认证,来访问 Git 的项目库</h2>
<ul>
<li>基于 API Token : 将 GIT的 token 添加进来.</li>
</ul>
<h3 id="_1"><a name="user-content-_1" href="#_1" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>项目通用配置</h3>
<ul>
<li>插件gitlab hook plugin，可以识别gitlab发送过来的提交信息，并触发对应的job</li>
<li>Environment Injector Plugin（自定义全局变量）</li>
<li>Email Extension Plugin（邮件）</li>
</ul>
<p>可以先看看下边的官方教程:</p>
<p><a href="https://berlin.gitbooks.io/jenkins/content/job/pei_zhi_bian_yi_can_shu.html">官方指南 教程</a></p>
<h5 id="_2"><a name="user-content-_2" href="#_2" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>项目编译参数</h5>
<p>设置 debug,test等:</p>
<blockquote>
<p>打开项目 -&gt; 选择参数化构建过程 -&gt; 点选 Choice 配置如下</p>
<p><img alt="" src="https://berlin.gitbooks.io/jenkins/content/pic/job/jb-02.jpg" /></p>
</blockquote>
<h5 id="_3"><a name="user-content-_3" href="#_3" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>项目构建参数</h5>
<p>设置构建参数:</p>
<blockquote>
<p>打开项目 -&gt; Build with Parameters -&gt; 配置如下</p>
<p><img alt="" src="https://berlin.gitbooks.io/jenkins/content/pic/job/jb-03.jpg" /></p>
</blockquote>
<h5 id="_4"><a name="user-content-_4" href="#_4" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>构建触发器</h5>
<blockquote>
<p>通常手动构建job不是我们想要的，我们想要让其自动构建，这就需要达到一定条件进行触发构建，所有就有了触发器<br />
详细的配置,参考<a href="https://berlin.gitbooks.io/jenkins/content/job/gou_jian_de_hong_fa_qi.html">官方文档</a></p>
</blockquote>
<p>Jenkins 支持多种触发器配置,包括：</p>
<h2 id="-build-periodicallybuild"><a name="user-content--build-periodicallybuild" href="#-build-periodicallybuild" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>- 定期进行构建（Build periodically），(隔一段时间build一次，不管版本库代码是否发生变化，通常不会采用此种方式)</h2>
<h2 id="-poll-scm-buildbuild"><a name="user-content--poll-scm-buildbuild" href="#-poll-scm-buildbuild" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>- 定期检测代码更新，如有更新则进行构建（Poll SCM） (隔一段时间比较一次源代码如果发生变更，那么就build。否则，不进行build)</h2>
<h2 id="-build-when-a-change-is-pushed-to-github"><a name="user-content--build-when-a-change-is-pushed-to-github" href="#-build-when-a-change-is-pushed-to-github" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>- 根据提交进行构建(Build when a change is pushed to GitHub)</h2>
<ul>
<li>jenkins上只需要配置源代码来自git地址，不需要任何额外的配置；</li>
<li>在gitlab的某个项目的web hook配置中，配置固定的触发地址：<code>http://your-jenkins-server/gitlab/build_now</code></li>
<li>当gitlab的指定项目有push后，当push完成时，会触发指定的jenkins server上的对应job，匹配原则为：git project url地址一致，branch一致；</li>
</ul>
<p><pre><code>H(25-30) 18 1-5： 工作日下午6点25到30分之间进行build
H 23 1-5：工作日每晚23:00至23:59之间的某一时刻进行build
H(0-29)/15：前半小时内每隔15分钟进行build（开始时间不确定） 
H/20：每隔20分钟进行build（开始时间不确定）
</code></pre><br />
- 根据提交进行构建（Build when a change is pushed to GitHub）<br />
- 定期检测代码更新，如有更新则进行构建（Poll SCM）</p>
<h6 id="jobs"><a name="user-content-jobs" href="#jobs" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Jobs构建方式\编译 配置</h6>
<p>Jenkins支持多种编译配置方式,包括：</p>
<ul>
<li>Xcode: iOS编译配置（安装Xcode integration插件）</li>
<li>Invoke Gradle script： Android编译配置(安装Gradle plugin插件)</li>
<li>Exceute Shell： 脚本方式</li>
</ul>
<p>对于iOS应用的构建,如果选择Xcode方式构建,需要配置好开发者证书. 推荐使用Exceute Shell方式,简单有效。</p>
<h6 id="jobs_1"><a name="user-content-jobs_1" href="#jobs_1" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Jobs构建后处理</h6>
<p>Artifacts和邮件通知配置等,<a href="https://gold.xitu.io/entry/5792b7320a2b580061ab0e27">参考</a></p>
<h3 id="github"><a name="user-content-github" href="#github" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>配置 github</h3>
<p>之所以要配置,是因为 Jenkins 默认不支持 GitHub,需要自行配置(默认支持 CVS\Subversion)</p>
<ul>
<li>1.在 GitHub 中,配置 token (保存此 token 紧接着就要用)</li>
</ul>
<blockquote>
<p>流程: github &ndash;&gt; setting &ndash;&gt; Personal Access Token &ndash;&gt; Generate new token</p>
</blockquote>
<p>详细配置如下图:</p>
<p><img alt="" src="http://img.hb.aicdn.com/df55935992514b80c0672f2d3ae55ce4f726f4731bdfe-eVrSec_fw658" /></p>
<ul>
<li>2.安装 GitHub Plugin</li>
</ul>
<p>如果此前已经没安装过</p>
<blockquote>
<p>流程:系统管理&ndash;&gt;插件管理&ndash;&gt;可选插件&ndash;&gt;直接安装 GitHub Plugin</p>
<p>Jenkins会自动帮你安装plain-credentials 、git 、 credentials 、 github-api</p>
</blockquote>
<ul>
<li>3.配置 GitHub Plugin</li>
</ul>
<blockquote>
<p>流程:系统管理 &ndash;&gt; 系统设置 &ndash;&gt; GitHub &ndash;&gt; Add GitHub Sever</p>
<p>Add GitHub Sever 页面 Kind 选择 Secrect text,Secret 贴入上文 GitHub 中配置的 Token,ID 可空白,并加上简单描述即可.</p>
</blockquote>
<p><img alt="" src="http://img.hb.aicdn.com/52b78661c0326778df8ea624bb680b59aa11c884106ee-Gos8u3_fw658" /></p>
<p>以上就完成了 GitHub 的配置.</p>
<h4 id="freestyle"><a name="user-content-freestyle" href="#freestyle" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>创建freestyle任务</h4>
<p>主界面 &ndash;&gt; 点击新建 &ndash;&gt; 输入任务名称,并选择任务类型,然后确定</p>
<p><img alt="" src="http://img.hb.aicdn.com/c51fae690f1e3d46ae3b63c432fd275add8808b524354-J7rfU3_fw658" /></p>
<ul>
<li>1.基本信息:填入 GitHub 项目主页</li>
</ul>
<p><img alt="" src="http://img.hb.aicdn.com/0503e68febf932d309025bba65434d9507d223cde4ae-ECKWwr_fw658" /></p>
<ul>
<li>2.项目源码管理:</li>
</ul>
<blockquote>
<p>填入项目的 git 地址&ndash;&gt;点击 Add 添加 git 账户,以便读写该项目&ndash;&gt;Branches to build 用于监听分支,**表示监听全部分支&ndash;&gt;Local subdirectory for repo 表示项目相对于默认路径的保存路径,之后都会在此路径进行构建执行.</p>
</blockquote>
<p><img alt="" src="http://img.hb.aicdn.com/969a90bcc1d7d12c26164dd7f7ef11b1048a24a3e321-l92EFL_fw658" /></p>
<ul>
<li>3.构建触发器/构建环境:</li>
</ul>
<blockquote>
<p>GitHub hook trigger for GITScm polling 选项:当 GitHub 有版本库更新时触发 Jenkins 进行构建<br />
Poll SCM 选项:定期检查版本库是否有更新(使用Schedule语法)</p>
</blockquote>
<p><img alt="" src="http://img.hb.aicdn.com/cd592746112fbda093692f630b3b6c8c8e260d4134bac-9nqLy0_fw658" /></p>
<ul>
<li>4.构建</li>
</ul>
<p><img alt="" src="http://img.hb.aicdn.com/e0ce275c67b89629017b4a706b2b6cc6b283ed5660c6-0fzKor_fw658" /></p>
<p>这里指定脚本</p>
<p><pre><code class="shell">#!/usr/bin/env zsh --login

rvm use 2.0.0
ruby --version
bundle
bundle --version
bin/pod
/usr/bin/xcodebuild -scheme 'UITEST' -workspace UITEST.xcworkspace -destination &quot;platform=iOS Simulator,name=iPhone Retina (4-inch),OS=latest&quot; -configuration Debug clean build test ONLY_ACTIVE_ARCH=NO
</code></pre><br />
- 5\ 构建后的操作<br />
Jenkins默认只能构建前执行shell,不能构建后执行shell.当有该需求时 Jenkins 的 PostBuildScript plugin 插件实现这个功能.</p>
<p><img alt="" src="http://img.hb.aicdn.com/517fe769dfaed57c8a9e6389d940bbbe1a50bfe83a7c-3uou8P_fw658" /></p>
<p>以上便完成了任务的配置.</p>
<h5 id="githubwebhook"><a name="user-content-githubwebhook" href="#githubwebhook" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>配置Github仓库的Webhook</h5>
<blockquote>
<p>进入GitHub上指定的项目 &ndash;&gt; setting &ndash;&gt; WebHooks&amp;Services &ndash;&gt; add webhook &ndash;&gt; 输入刚刚部署jenkins的服务器的IP</p>
</blockquote>
<p>这样,每次 push 都会触发一次build.</p>
<p>然而,我的 Jenkins 是本地的,在 GitHub 并不能直接访问到我的电脑,so,设置是无效的....</p>
<h3 id="gitlab"><a name="user-content-gitlab" href="#gitlab" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>配置 GitLab</h3>
<p><strong>集成目的: Gitlab 有新的推送,就会触发 Jenkins 构建.构建状态反馈给 Gitlab</strong></p>
<h5 id="1_1"><a name="user-content-1_1" href="#1_1" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>1. 安装插件</h5>
<blockquote>
<p><a href="https://docs.gitlab.com/ee/integration/jenkins.html">Gitlab官方教程</a><br />
<a href="https://docs.gitlab.com/ee/integration/jenkins.html">Gitlab 官方教程2</a></p>
</blockquote>
<ul>
<li>1). 安装 Gitlab 插件 </li>
</ul>
<blockquote>
<p>系统管理 -&gt; 管理插件 -&gt; 可选插件 :中选择GitLab Plugin 和 Gitlab Hook Plugin 这两项，然后安装.</p>
</blockquote>
<ul>
<li>2). 安装 Xcode 插件</li>
</ul>
<blockquote>
<p>同上,安装 Xcode integration</p>
</blockquote>
<ul>
<li>3). 安装签名证书管理插件<br />
OS打包内测版时,需要发布证书及相关签名文件,因此这两个插件对于管理iOS证书非常方便.</li>
</ul>
<blockquote>
<p>同上,安装 Credentials Plugin 和 Keychains and Provisioning Profiles Management </p>
</blockquote>
<h5 id="2-api-token"><a name="user-content-2-api-token" href="#2-api-token" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>2. 配置 API Token</h5>
<blockquote>
<ol>
<li>
<p>Gitlabe: Copy the private API token from [ Profile Settings -&gt; Account ]</p>
</li>
<li>
<p>Jenkins: Go to [ Manage Jenkins -&gt; Configure System ] -&gt; [GitLab] 粘贴 Gitlab 主机地址,以及 API Token</p>
</li>
<li>
<p>可能2步骤没有 API Token 选项,因为都已经集成到 Credentials 中了,所以,要进入 Credentials 中,然后 添加新的凭证:</p>
</li>
</ol>
<p>首页点击 Credentials -&gt; 点击 System -&gt; 点击底部的 Glopbal credentials(unrestricted) -&gt; 跳入新的页面,点击 Add Credentials -&gt; Kind 选择 [GitLab API Token],然后粘贴上述的 token ,要注意的是, Description 需要写清楚,不然容易弄混淆(GitHub 也添加了 Secret text, 容易混)</p>
<p>以上前提是有安装插件:Plain Credentiles Plugin ,以及相关插件. 否则不会有 gitlab API token 这个选项的.</p>
</blockquote>
<h5 id="3-gitlab"><a name="user-content-3-gitlab" href="#3-gitlab" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>3. 配置 Gitlab 账号密码</h5>
<p>在系统配置里,添加 类型: Username with password -&gt; 配置账号密码即可.</p>
<h5 id="4-ssh"><a name="user-content-4-ssh" href="#4-ssh" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>4. 配置 SSH</h5>
<p>1.直接获取:</p>
<pre><code class="shell">$ ls ~/.ssh
$ cat id_rsa # 显示
$ pbcopy &lt; ~/.ssh/id_rsa #复制
# 然后 粘贴到 Jenkins 中,并输入最初始的密码即可.如下图
</code></pre>

<p><img alt="" src="http://img.hb.aicdn.com/9756ed06006b5d816ac3e4fdc9891249fd7879f116026-K0Lsxk_fw658" /></p>
<p>2.创建新的 SSH</p>
<pre><code class="shell">$ ssh-keygen -t rsa -C “Your email” 
# 私钥id_rsa:本机添加秘钥到秘钥管理器:
$ eval &quot;$(ssh-agent -s)&quot;
$ ssh-add ~/.ssh/id_rsa
# 私钥copy添加进 Jenkins（private key选项）
$ pbcopy &lt; ~/.ssh/id_rsa
# 公钥id_rsa.pub:复制id_rsa.pub里面的公钥添加到Gitlab上  
$ pbcopy &lt; ~/.ssh/id_rsa.pub

</code></pre>

<p>SSH 添加路径为:</p>
<blockquote>
<p>系统管理 -&gt; 系统设置 -&gt; Gitlab 栏 点击 Add 添加,或者使用如下地址:</p>
<p><a href="http://localhost:8080/credentials/store/system/domain/_/">http://localhost:8080/credentials/store/system/domain/_/</a></p>
</blockquote>
<h4 id="freestyle_1"><a name="user-content-freestyle_1" href="#freestyle_1" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>创建freestyle任务</h4>
<p>主界面 &ndash;&gt; 点击新建 &ndash;&gt; 输入任务名称,并选择 freestyle 任务类型,然后确定</p>
<ul>
<li>源码管理:</li>
</ul>
<blockquote>
<blockquote>
<p>输入项目 git 协议地址(<a href="mailto:git@your.gitlab.server">git@your.gitlab.server</a>:gitlab_group/gitlab_project.git) <br />
&ndash;&gt; 证书类型选择:相应的 SSH .<br />
&ndash;&gt;在高级设置中，将名称设置为origin,将Refspec设置为 +refs/heads/<em>:refs/remotes/origin/</em> +refs/merge-requests/<em>/head:refs/remotes/origin/merge-requests/</em></p>
</blockquote>
</blockquote>
<ul>
<li></li>
<li>构建触发器:Build when a change is pushed to GitLab. 注意,这里的地址,粘贴在 Gitlab 上 的 WebHook 中</li>
<li></li>
<li>
<p>更加详细的任务配置,参考插件<a href="https://github.com/jenkinsci/gitlab-plugin#using-it-with-a-job">官方文档</a></p>
</li>
</ul>
<h3 id="xcode-builder"><a name="user-content-xcode-builder" href="#xcode-builder" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Xcode Builder</h3>
<h6 id="xcode-builder_1"><a name="user-content-xcode-builder_1" href="#xcode-builder_1" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Xcode Builder 设置</h6>
<blockquote>
<p>系统管理–&gt;系统设置-&gt;Xcode Builder<br />
默认 path 不变 -&gt; 点击 Add 需填写的内容：</p>
<p><img alt="" src="http://img.blog.csdn.net/20160216141930768" /></p>
<blockquote>
<p>Keychain Name：iPhone Distribution: *（dis证书常用名）</p>
<p>Keychain path：${HOME}/Library/Keychains/login.keychain（dis证书路径）</p>
<p>Keychain password：*</p>
<p>Add to keychain search path after build：Yes</p>
<p>Default keychain:iPhone Distribution: *</p>
</blockquote>
</blockquote>
<ul>
<li>
<ol>
<li>General build settings: </li>
</ol>
</li>
</ul>
<blockquote>
<p>++ 填写Target 名字</p>
<p>++ Clean before build? YES</p>
<p>++ Pack application and build .ipa? YES</p>
<p>++ .ipa filename pattern IPA 路径:AD_Demo_${SHORT_VERSION}(固定写法:targetName_${SHORT_VERSION})</p>
<p>++ Output directory IPA输出位置 ${WORKSPACE}/build/${BUILD_NUMBER}/<br />
</p>
</blockquote>
<ul>
<li>2.Code signing &amp; OS X keychain options: </li>
</ul>
<p>在系统Xcode Builder（钥匙串设置）已配置,上边已配置<br />
- 3.Advanced Xcode build options: </p>
<blockquote>
<p>++ “Clean test reports?”  YES</p>
<p>++Build output directory：${WORKSPACE}/build/${BUILD_NUMBER}/<br />
</p>
</blockquote>
<p><img alt="" src="http://img.blog.csdn.net/20160218095046760" /><br />
<img alt="" src="http://img.blog.csdn.net/20160218095059932" /><br />
<img alt="" src="http://img.blog.csdn.net/20160218095117084" /><br />
- 4. Versioning 构建后的设置 :SHELL 脚本</p>
<p><img alt="" src="http://img.blog.csdn.net/20160218100247953" /></p>
<p>1).点击增加 Shell 脚本:</p>
<pre><code class="shell">&quot;${WORKSPACE}/build/${BUILD_NUMBER}&quot;

for file in &quot;*.ipa&quot;
do
    PLIST_NAME=`echo $file`
done

PLIST_NAME=${PLIST_NAME%.*}

cd &quot;${WORKSPACE}/build&quot;
echo &quot;PLIST_NAME=$PLIST_NAME&quot; &gt; jenkinsUserGlobal.properties

cat &lt;&lt; EOF &gt; ${WORKSPACE}/build/${BUILD_NUMBER}/$PLIST_NAME.plist
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;
&lt;plist version=&quot;1.0&quot;&gt;
&lt;dict&gt;
        &lt;key&gt;items&lt;/key&gt;
        &lt;array&gt;
                &lt;dict&gt;
                        &lt;key&gt;assets&lt;/key&gt;
                        &lt;array&gt;
                                &lt;dict&gt;
                                        &lt;key&gt;kind&lt;/key&gt;
                                        &lt;string&gt;software-package&lt;/string&gt;
                                        &lt;key&gt;url&lt;/key&gt;
                                        &lt;string&gt;https://127.0.0.1/$PLIST_NAME.ipa&lt;/string&gt;
                                &lt;/dict&gt;
                        &lt;/array&gt;
                        &lt;key&gt;metadata&lt;/key&gt;
                        &lt;dict&gt;
                                &lt;key&gt;bundle-identifier&lt;/key&gt;
                                &lt;string&gt;com.3code.ADDemo&lt;/string&gt;
                                &lt;key&gt;bundle-version&lt;/key&gt;
                                &lt;string&gt;1&lt;/string&gt;
                                &lt;key&gt;kind&lt;/key&gt;
                                &lt;string&gt;software&lt;/string&gt;
                                &lt;key&gt;title&lt;/key&gt;
                                &lt;string&gt;ADDemo&lt;/string&gt;
                        &lt;/dict&gt;
                &lt;/dict&gt;
        &lt;/array&gt;
&lt;/dict&gt;
&lt;/plist&gt;
EOF
</code></pre>

<p>2). 点击增加 Inject environment variables</p>
<p>并设置:</p>
<blockquote>
<p>需填写的内容：(将在Execute shell中生成的全局变量文件地址放入 Properties File Path中)<br />
Properties File Path：${WORKSPACE}/build/jenkinsUserGlobal.properties</p>
</blockquote>
<p><img alt="" src="http://img.blog.csdn.net/20160218100610924" /></p>
<ul>
<li>5.构建后的操作: 设置邮件</li>
</ul>
<p><img alt="" src="http://img.blog.csdn.net/20160218100726636" /><br />
触发器：构建成功、失败触发(扩展一下：失败点“高级”设置只发送给自己) <br />
<img alt="" src="http://img.blog.csdn.net/20160218100837965" /></p>
<blockquote>
<p>需填写的内容：</p>
<p>Project Recipient List：邮件接收人（多个时用”,“分割）</p>
<p>Project Reply-To List：$DEFAULT_REPLYTO</p>
<p>Content Type：选择”HTML(text/html)“</p>
<p>Default Subject：标题: <strong>${PROJECT_NAME}构建通知:第${BUILD_NUMBER}次持续集成${PLIST_NAME}构建${BUILD_STATUS}</strong></p>
<p>Default Content:（将ipa全局变量传递到邮件生成下载链接和链接二维码）,如下:</p>
</blockquote>
<pre><code class="xml">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta charset=&quot;UTF-8&quot;&gt;
&lt;title&gt;${ENV, var=&quot;JOB_NAME&quot;}-第${BUILD_NUMBER}次构建日志&lt;/title&gt;
&lt;/head&gt;

&lt;body leftmargin=&quot;8&quot; marginwidth=&quot;0&quot; topmargin=&quot;8&quot; marginheight=&quot;4&quot;
    ffset=&quot;0&quot;&gt;
    &lt;table width=&quot;95%&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;
        style=&quot;font-size: 11pt; font-family: Tahoma, Arial, Helvetica, sans-serif&quot;&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;h2&gt;
                    &lt;font color=&quot;#0000FF&quot;&gt;构建结果 - ${BUILD_STATUS}&lt;/font&gt;
                &lt;/h2&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
                &lt;td&gt;&lt;h2&gt;
                    &lt;font color=&quot;#FF0000&quot;&gt;App下载链接:&lt;a href=&quot;itms-services://?action=download-manifest&amp;url=https://******/${PLIST_NAME}.plist&quot;&gt;itms-services://?action=download-manifest&amp;url=https://127.0.0.1/${PLIST_NAME}.plist&lt;/a&gt;&lt;/font&gt;
                &lt;/h2&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
               &lt;td&gt;&lt;h2&gt;
                      &lt;font color=&quot;#FF0000&quot;&gt;二维码图片:&lt;/font&gt;
               &lt;/h2&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
                &lt;td&gt;
                    &lt;img src=&quot;http://qr.liantu.com/api.php?text=itms-services://?action=download-manifest%26url=https://******/${PLIST_NAME}.plist&quot; height=&quot;300&quot; width=&quot;300&quot;&gt;
                &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;br /&gt;
            &lt;b&gt;&lt;font color=&quot;#0B610B&quot;&gt;构建信息&lt;/font&gt;&lt;/b&gt;
            &lt;hr size=&quot;2&quot; width=&quot;100%&quot; align=&quot;center&quot; /&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;
                &lt;ul&gt;
                    &lt;li&gt;项目名称&amp;nbsp;：&amp;nbsp;${PROJECT_NAME}&lt;/li&gt;
                    &lt;li&gt;构建编号&amp;nbsp;：&amp;nbsp;第${BUILD_NUMBER}次构建&lt;/li&gt;
                    &lt;li&gt;SVN&amp;nbsp;版本：&amp;nbsp;${SVN_REVISION}&lt;/li&gt;
                    &lt;li&gt;触发原因：&amp;nbsp;${CAUSE}&lt;/li&gt;
                    &lt;li&gt;构建日志：&amp;nbsp;&lt;a href=&quot;${BUILD_URL}console&quot;&gt;${BUILD_URL}console&lt;/a&gt;&lt;/li&gt;
                    &lt;li&gt;构建&amp;nbsp;&amp;nbsp;Url&amp;nbsp;：&amp;nbsp;&lt;a href=&quot;${BUILD_URL}&quot;&gt;${BUILD_URL}&lt;/a&gt;&lt;/li&gt;
                    &lt;li&gt;工作目录&amp;nbsp;：&amp;nbsp;&lt;a href=&quot;${PROJECT_URL}ws&quot;&gt;${PROJECT_URL}ws&lt;/a&gt;&lt;/li&gt;
                    &lt;li&gt;项目&amp;nbsp;&amp;nbsp;Url&amp;nbsp;：&amp;nbsp;&lt;a href=&quot;${PROJECT_URL}&quot;&gt;${PROJECT_URL}&lt;/a&gt;&lt;/li&gt;
                &lt;/ul&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;b&gt;&lt;font color=&quot;#0B610B&quot;&gt;Changes Since Last
                        Successful Build:&lt;/font&gt;&lt;/b&gt;
            &lt;hr size=&quot;2&quot; width=&quot;100%&quot; align=&quot;center&quot; /&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;
                &lt;ul&gt;
                    &lt;li&gt;历史变更记录 : &lt;a href=&quot;${PROJECT_URL}changes&quot;&gt;${PROJECT_URL}changes&lt;/a&gt;&lt;/li&gt;
                &lt;/ul&gt; ${CHANGES_SINCE_LAST_SUCCESS,reverse=true, format=&quot;Changes for Build #%n:&lt;br /&gt;%c&lt;br /&gt;&quot;,showPaths=true,changesFormat=&quot;&lt;pre&gt;[%a]&lt;br /&gt;%m&lt;/pre&gt;&quot;,pathFormat=&quot;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;%p&quot;}
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;b&gt;Failed Test Results&lt;/b&gt;
            &lt;hr size=&quot;2&quot; width=&quot;100%&quot; align=&quot;center&quot; /&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;pre
                    style=&quot;font-size: 11pt; font-family: Tahoma, Arial, Helvetica, sans-serif&quot;&gt;$FAILED_TESTS&lt;/pre&gt;
                &lt;br /&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;b&gt;&lt;font color=&quot;#0B610B&quot;&gt;构建日志 (最后 100行):&lt;/font&gt;&lt;/b&gt;
            &lt;hr size=&quot;2&quot; width=&quot;100%&quot; align=&quot;center&quot; /&gt;&lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;&lt;textarea cols=&quot;80&quot; rows=&quot;30&quot; readonly=&quot;readonly&quot;
                    style=&quot;font-family: Courier New&quot;&gt;${BUILD_LOG, maxLines=100}&lt;/textarea&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

<p>邮件截图</p>
<p><img alt="" src="http://img.blog.csdn.net/20160218103409264" /><br />
<img alt="" src="http://img.blog.csdn.net/20160218103358248" /></p>
<h3 id="target"><a name="user-content-target" href="#target" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>多 Target 扩展</h3>
<h3 id="jenkins-shell"><a name="user-content-jenkins-shell" href="#jenkins-shell" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Jenkins Shell 脚本</h3>
<p>在 Jenkins 的任务里面,在构建\构建后,都可选择 Execute shell ,作为构建前或者构建后要执行的 shell 脚本.</p>
<p>python\perl\ruby 等脚本其实也是 shell 脚本,因此这里的 Shell 可以扩展为 python\perl\ruby<br />
等。</p>
<p>常见脚本如:</p>
<p>1\此脚本:在jenkins构建完成后,远程copy配置文件到项目中,并重启tomcat</p>
<pre><code class="shell">#!/bin/sh
#datetime: 2017-2-7 17:00
#author:3code
#desc:此脚本用来在jenkins构建完成后，远程copy配置文件到项目中，并重启tomcat

#copy API工程的配置文件
cp -r /data/apache-tomcat-7.0.56/build/API/*  /data/apache-tomcat-7.0.56/webapps/API/WEB-INF/classes

#重启tomcat
bash /data/apache-tomcat-7.0.56/bin/shutdown.sh

sleep 30s

bash /data/apache-tomcat-7.0.56/bin/startup.sh
</code></pre>

<p><strong>Tips:</strong><br />
- 对于刚接触Jenkins的同学可能有很多需要配置的地方不知道要怎么填，这时可以点击每一个填空后的？，就会弹出详细的提示。<br />
- 官方的wiki是很好的入门教程https://wiki.jenkins-ci.org/display/JENKINS/Home</p>
<h3 id="_5"><a name="user-content-_5" href="#_5" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>其他</h3>
<ul>
<li>Jenkins 的界面是可以自定义的,<a href="https://wiki.jenkins-ci.org/display/JENKINS/Simple+Theme+Plugin">参考此处</a></li>
<li><a href="https://runningyoung.github.io/2016/04/01/2016-04-05-jenkins2/">优秀:Jenkins + Gitlab + 蒲公英 + 邮件通知</a></li>
<li><a href="http://blog.csdn.net/fengshi_sh/article/details/50669754">优秀:jenkins+xcode+svn+七牛</a></li>
</ul>
<p><a href="http://www.itgo.me/a/x9151986573431569483">构建iOS持续集成平台（三）——CI服务器与自动化部署</a><br />
<a href="http://blog.fir.im/fir_im_weekly160505/">fir.im weekly - 「 持续集成 」实践教程合集</a><br />
<a href="http://blog.flow.ci/cicd_difference/">谈谈持续集成，持续交付，持续部署之间的区别</a><br />
<a href="http://blog.caoyue.me/post/react-native-travis-ci-ios">使用Travis CI自动部署React Native项目（iOS篇）</a><br />
<a href="http://www.infoq.com/cn/articles/build-ios-continuous-integration-platform-part3">构建iOS持续集成平台（三）——CI服务器与自动化部署</a><br />
&hellip;<br />
<a href="https://objccn.io/issue-6-5/">为 iOS 建立 Travis CI</a><br />
<a href="https://gold.xitu.io/entry/57a982d10a2b58005869d8dc">iOS 持续集成 &ndash;Travis CI + Fir.im 自动编译发布</a><br />
<a href="http://yeziahehe.com/2016/08/07/use_travis_ci_for_ios_project/">iOS 持续集成&ndash;Travis CI + Fir.im自动编译发布</a><br />
<a href="https://objccn.io/issue-6-5/">为 iOS 建立 Travis CI</a><br />
<a href="https://docs.docker.com/docker-hub/builds/">在Docker Hub上配置自动构建</a><br />
<a href="http://www.jianshu.com/p/19c2b13e81fa">利用pod trunk发布程序</a><br />
<a href="http://www.55118885.com/w/166141242.html">使用GitLab来实现IOS项目的持续集成CI</a><br />
<a href="http://blog.fir.im/jenkinsgithubfir_cli-xing-ming-ling-cong-yuan-ma-dao-fir-im/">Jenkins + GitHub + fir-cli 一行命令从源码到 fir.im</a><br />
<a href="http://www.2cto.com/kf/201411/356826.html">用持续集成工具Travis进行构建和部署</a></p>
<h4 id="firim"><a name="user-content-firim" href="#firim" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>fir.im</h4>
<p><a href="http://www.jianshu.com/p/f17caec72f0b">使用 fir CLI插件上传 Swift 应用至fir.im</a></p>
<h4 id="travis"><a name="user-content-travis" href="#travis" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>Travis</h4>
<p>相关的文章:<a href="https://blog.jamespan.me/2015/11/01/ci-your-hexo-blog">Travis</a></p>
<blockquote>
<p><a href="http://ios.jobbole.com/87803/">使用 TestFlight 进行 App Beta 版测试</a><br />
<a href="http://www.jianshu.com/p/27545c2d4d8b">使用TestFlight进行App构建版本测试</a><br />
<a href="https://onevcat.com/2012/01/testflight/">onevcat testflight</a><br />
持续部署是指当交付的代码通过评审之后，自动部署到生产环境中。持续部署是持续交付的最高阶段。这意味着，所有通过了一系列的自动化测试的改动都将自动部署到生产环境。它也可以被称为“Continuous Release”。</p>
</blockquote>
<h2 id="_6"><a name="user-content-_6" href="#_6" class="headeranchor-link" aria-hidden="true"><span class="headeranchor"></span></a>自动发布</h2>
<ul>
<li>Fastlane 是一组工具套件,旨在实现iOS应用发布流程的自动化，并且提供一个运行良好的持续部署流程.</li>
<li>使用场景: push 时执行单元测试,集成测试;创建屏幕截图发给客户;构建分发 Beta 版本;构建并分发到 appstore;</li>
<li>支持与Jenkins和CocoaPods，xctools等其他第三方工具的集成</li>
<li>博客教程:<a href="http://www.infoq.com/cn/news/2015/01/fastlane-ios-continuous-deploy">http://www.infoq.com/cn/news/2015/01/fastlane-ios-continuous-deploy</a></li>
<li>官方教程:<a href="https://docs.fastlane.tools/getting-started/ios/screenshots/">https://docs.fastlane.tools/getting-started/ios/screenshots/</a></li>
</ul></article></body></html>
                </div>
                <div class="read-all">
                    <a  href="/2017/02/08/AD-jenkins/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2017/02/07/AD-Fastlane/"> 持续集成系列 - Fastlane的黑魔法:自动打包编译上传 AppStore</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2017-02-07
                    </div>
                    <div class="label-card">
                        <i class="fa fa-user"></i>3行代码
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#CI" title="Category: CI" rel="category">CI</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#fastlane" title="Tag: fastlane" rel="tag">fastlane</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#fastlane-" id="markdown-toc-fastlane-">Fastlane 简介</a>    <ul>
      <li><a href="#section" id="markdown-toc-section">1.主要使用场:</a></li>
      <li><a href="#section-1" id="markdown-toc-section-1">2.工具集</a></li>
      <li><a href="#section-2" id="markdown-toc-section-2">3.常见命令</a></li>
    </ul>
  </li>
  <li><a href="#fastlane--1" id="markdown-toc-fastlane--1">fastlane 入门实战</a>    <ul>
      <li><a href="#fastlane" id="markdown-toc-fastlane">1.安装 fastlane</a>        <ul>
          <li><a href="#app-id" id="markdown-toc-app-id">1.1 创建App ID\描述文件</a></li>
          <li><a href="#section-3" id="markdown-toc-section-3">1.2 安装</a></li>
          <li><a href="#fastlane-1" id="markdown-toc-fastlane-1">1.3 为项目配置 fastlane</a></li>
        </ul>
      </li>
      <li><a href="#fastlane--2" id="markdown-toc-fastlane--2">2.fastlane 文件配置</a>        <ul>
          <li><a href="#metadata-" id="markdown-toc-metadata-">2.1 配置 metadata 文件夹</a></li>
          <li><a href="#section-4" id="markdown-toc-section-4">2.2 配置证书</a></li>
          <li><a href="#fastlane--itc" id="markdown-toc-fastlane--itc">2.3 将 fastlane 本地配置上传至 ITC</a></li>
        </ul>
      </li>
      <li><a href="#xcode-" id="markdown-toc-xcode-">3.Xcode 配置</a></li>
      <li><a href="#snapshot--xctest" id="markdown-toc-snapshot--xctest">4.Snapshot 截图和 XCTest</a></li>
      <li><a href="#ipa-" id="markdown-toc-ipa-">5.创建 IPA 文件</a></li>
      <li><a href="#ipa--itc" id="markdown-toc-ipa--itc">6.上传 IPA 文件到 ITC</a></li>
      <li><a href="#deliverfile" id="markdown-toc-deliverfile">7.配置 Deliverfile</a></li>
      <li><a href="#appstore-" id="markdown-toc-appstore-">8.提交 AppStore 审核</a></li>
      <li><a href="#section-5" id="markdown-toc-section-5">9.使用一键命令</a></li>
      <li><a href="#section-6" id="markdown-toc-section-6">10.参考</a></li>
    </ul>
  </li>
</ul>

<blockquote>
  <p>有关神器 Fastlane 持续集成\部署的文章网上挺多,本文定位是入门教程,针对 iOS 应用的持续部署,<strong>只需一条命令就可实现从 Xcode 项目到 编译\打包\构建\提交审核</strong></p>

  <p>文章稍微有点长,涵盖内容为:fastlane 简介\安装\配置 + Snapshot 截图 + XCTest + 一键上传App Store</p>

  <p>说明:本文将 Apple Dev Center 简称为 ADC; iTunes Connect 简称为 ITC</p>

</blockquote>

<ul>
  <li>首发文章及代码请<a href="https://github.com/mythkiven/AD_Fastlane">戳一下</a></li>
  <li>先放图看 fastlane 实现自动上传功能:</li>
</ul>

<p>进度:</p>

<p><img src="https://ooo.0o0.ooo/2017/02/08/589a9ef7823dc.png" alt="" /></p>

<p>提交成功,等待审核
<img src="https://ooo.0o0.ooo/2017/02/08/589aaed07d991.png" alt="" /></p>

<h2 id="fastlane-">Fastlane 简介</h2>

<p>fastlane 是一个完全开源的项目,包含一组 Ruby 实现的工具集,能完成 iOS 和 Android 工程 的自动化构建\测试和发布等功能,<a href="https://krausefx.com/blog/fastlane-is-now-part-of-fabric">现被Twitter收购,是Fabric的一部分</a>.fastlane 强大之处就在于其提供的工具全,基本可以覆盖打包测试发布的所有流程,如下图:</p>

<p><img src="https://ooo.0o0.ooo/2017/02/08/589ace59a6210.png" alt="" /></p>

<p>fastlane 的每一个工具都对应一个 Ruby 脚本,用来执行某一特定的任务,而最妙的是可以通过配置文件将不同的工具灵活的结合在一起,从而形成一个完整的自动化流程,实现一键上传 ITC,从而缩短用于构建发布的时间.</p>

<h5 id="section">1.主要使用场:</h5>

<ul>
  <li>提交时执行测试（包括单元测试和集成测试）</li>
  <li>构建并分发内部测试\公开测试版本</li>
  <li>构建生产版本并上传至 ITC（包括更新配置文件,创建新的屏幕截图,上传应用并提交审核）</li>
  <li>…</li>
</ul>

<h5 id="section-1">2.工具集</h5>

<p>fastlane 将如下的工具套件有机地结合起来,从管理证书到单元测试,从编译打包到上传发布,都能通过命令行轻松完成.该套件支持与 Jenkins 和 CocoaPods,xctools 等其他第三方工具的集成,并且能够定义多个通道（lanes）以支持不同的部署目标.</p>

<ul>
  <li>deliver: 将应用在 ITC 上所需数据提交至 ITC (包括:截图,配置文件,ipa包)</li>
  <li>snapshot: 依靠 UI Test 完成截图</li>
  <li>frameit: 快速地把应用截图放入设备框里</li>
  <li>pem: 可以自动化地生成和更新应用推送通知描述文件</li>
  <li>sigh: 创建\更新\下载和修复 provisioning profiles,支持App Store, Ad Hoc, Development和企业profiles</li>
  <li>gym: 编译\打包iOS app,生成签名的ipa文件</li>
  <li>…</li>
</ul>

<h5 id="section-2">3.常见命令</h5>

<p>fastlane 命令中,个人觉得下面两个较为常用:</p>

<ul>
  <li>列出所有的 fastlane 的 actions:</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>$ fastlane actions
</code></pre>
</div>

<ul>
  <li>fastlane action [action_name]: 显示某一个 action 的详细配置</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>$  fastlane action match
</code></pre>
</div>

<h2 id="fastlane--1">fastlane 入门实战</h2>

<h3 id="fastlane">1.安装 fastlane</h3>

<h5 id="app-id">1.1 创建App ID\描述文件</h5>

<ul>
  <li>本教程目标是上传 ITC ,因此需要提前在 ADC 和 ITC 中创建 App ID\描述文件\App</li>
  <li>这里使用的项目是 AD Demo,代码见 <a href="https://github.com/mythkiven/AD_Fastlane">GitHub</a></li>
</ul>

<p><img src="https://ooo.0o0.ooo/2017/02/06/589845eaa299d.png" alt="" />
<img src="https://ooo.0o0.ooo/2017/02/06/589847204b77a.png" alt="" /></p>

<h5 id="section-3">1.2 安装</h5>

<p>查看 Ruby 版本,低于2.0最好升级</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ruby -v
</code></pre>
</div>

<p>检查 Xcode CLT 是否安装</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ xcode-select --install
</code></pre>
</div>

<p>安装 fastlane</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ sudo gem install -n /usr/local/bin fastlane
</code></pre>
</div>

<p>检查版本 fastlane</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ fastlane --version
fastlane installation at path:
/Library/Ruby/Gems/2.0.0/gems/fastlane-2.14.2/bin/fastlane
-----------------------------
fastlane 2.14.2
</code></pre>
</div>

<p>OK,安装完成</p>

<h5 id="fastlane-1">1.3 为项目配置 fastlane</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>$ cd 项目目录
$ fastlane init
</code></pre>
</div>

<p>如果期间报错 <code class="highlighter-rouge">Connection reset by peer - SSL_Connect</code>,就需要执行:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ brew update &amp;&amp; brew install ruby
// 重装
$ sudo gem install -n /usr/local/bin fastlane
</code></pre>
</div>

<p>然后重新执行</p>
<div class="highlighter-rouge"><pre class="highlight"><code>$ fastlane init
</code></pre>
</div>

<ul>
  <li>期间会让你输入 Apple ID 账号密码(这个信息会存在钥匙串中,后续使用无需再输入密码)</li>
  <li>会检测当前的 app identifier 是否在  ADC 中</li>
  <li>会检测当前 app 是否在 ITC 中</li>
  <li>如果已经在 ADC 和 ITC 中创建相应的信息,那么过程会很顺利,如下图:</li>
</ul>

<p><img src="https://ooo.0o0.ooo/2017/02/07/58992aea708c6.png" alt="" /></p>

<p>并在 Xcode 项目目录中生成如下文件:</p>

<p><img src="https://ooo.0o0.ooo/2017/02/07/58992b1016443.png" alt="" /></p>

<p>注意:如果没有在 ITC 中创建 App ,也就不会创建上述两个文件夹;当然也可以后续创建,执行如下操作即可:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ fastlane produce init
</code></pre>
</div>

<h3 id="fastlane--2">2.fastlane 文件配置</h3>

<p>fastlane 的各文件解释如下:</p>

<ul>
  <li>Appfile:用于存储应用程序标识符和Apple ID 等信息</li>
  <li>Fastfile:配置管理 lane</li>
  <li>Deliverfile:配置应用在 ITC 中的各种信息,和 ICC 中的数据是一一对应的</li>
  <li>metadata:包含应用在 ITC 中的各种信息</li>
  <li>screenshots:包含截图数据</li>
</ul>

<p>需要注意的是,metadata 和 Deliverfile,都可以配置 ITC 的数据,但后者优先级高.正如下图:</p>

<p><img src="https://ooo.0o0.ooo/2017/02/08/589aba7c0b998.png" alt="" /></p>

<p><img src="https://ooo.0o0.ooo/2017/02/08/589aba7c1d252.png" alt="" /></p>

<p>下文先在 metadata 文件夹中进行配置用于演示,在文末会删除 metadata 中的配置文本,全部配置在 Deliverfile 中.</p>

<h5 id="metadata-">2.1 配置 metadata 文件夹</h5>

<p>修改 App 描述:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ cd metadata 
$ cd zh-Hans
$ vim description.txt
</code></pre>
</div>

<p>修改关键字:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ vim keywords.txt
</code></pre>
</div>

<p>修改 support_url:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ vim support_url.txt
</code></pre>
</div>

<p>修改 copyright:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ vim copyright.txt
</code></pre>
</div>

<p>等等,其他信息的修改类似.</p>

<p>然后创建分级文件:itunes_rating_config.json,这个和 ICC 中的分级是对应的.</p>

<div class="language-json highlighter-rouge"><pre class="highlight"><code><span class="p">{</span><span class="nt">"CARTOON_FANTASY_VIOLENCE"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span><span class="nt">"REALISTIC_VIOLENCE"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"PROLONGED_GRAPHIC_SADISTIC_REALISTIC_VIOLENCE"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span><span class="nt">"PROFANITY_CRUDE_HUMOR"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span><span class="nt">"MATURE_SUGGESTIVE"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"HORROR"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
</span><span class="nt">"MEDICAL_TREATMENT_INFO"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span><span class="nt">"ALCOHOL_TOBACCO_DRUGS"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"GAMBLING"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"SEXUAL_CONTENT_NUDITY"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span><span class="nt">"GRAPHIC_SEXUAL_CONTENT_NUDITY"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> 
</span><span class="nt">"UNRESTRICTED_WEB_ACCESS"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
</span><span class="nt">"GAMBLING_CONTESTS"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
</div>

<p>此处配置参见<a href="https://github.com/fastlane/fastlane/blob/master/deliver/Reference.md">官方文档</a></p>

<p>然后将 App 图标添加至文件夹中,接下来要创建证书:</p>

<h5 id="section-4">2.2 配置证书</h5>

<p>修改 Fastfile:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ vim Fastfile
</code></pre>
</div>

<p>修改内容如下:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>fastlane_version "2.14.2"

default_platform :ios

platform :ios do
 
  # 当前任务的描述
  desc "Creating a code signing certificate and provisioning profile"
  # 任务名称
  lane :provision do
    # 创建 ITC 中的 App 信息
    produce(
      app_name: 'AD_Demo',
      language: 'zh-Hans',
      app_version: '1.0',
      sku: 'com.3code.ADDemo.Test'
    )
    # 使用证书创建私钥及签名
    cert
    # 每次运行时创建新的配置文件
    sigh(force: true)
  end
 
  error do |lane, exception|
  
  end
  
end
</code></pre>
</div>

<p>如果想创建 ad hoc 配置文件,需要指定sigh(adhoc: true).更多的信息参见:</p>

<ul>
  <li><a href="https://github.com/fastlane/fastlane/tree/master/fastlane/docs">官方文档</a></li>
  <li><a href="https://docs.fastlane.tools/actions/">fastlane actions</a></li>
</ul>

<h5 id="fastlane--itc">2.3 将 fastlane 本地配置上传至 ITC</h5>

<p>重新进入项目目录,执行如下操作:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ fastlane provision
</code></pre>
</div>

<p>等待一小会儿,终端提示成功创建证书配置:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>fastlane.tools finished successfully 🎉
</code></pre>
</div>

<p>打开 ICC 网页,会发现本地的配置,已经成功上传.</p>

<h3 id="xcode-">3.Xcode 配置</h3>

<p>xcode 配置也简单,只需要将项目修改至生产状态即可(描述文件).其它像构建版本号之类的不用理会, fastlane 会处理的.</p>

<h3 id="snapshot--xctest">4.Snapshot 截图和 XCTest</h3>

<p>snapshot 需要和 XCTest 配合使用,关于 XCTest,我的博客中<a href="www.3code.info/2017/01/23/AD-XCTest/">有一篇文章</a>做了简单介绍.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ fastlane snapshot init
</code></pre>
</div>

<p>目录中会生成一个 Snapfile 文件,用于配置截图信息,修改内容如下:</p>

<div class="highlighter-rouge"><pre class="highlight"><code># 图片尺寸
devices([
  "iPhone 5",
  "iPhone 6",
  "iPhone 6 Plus"
])
 
# 支持语言
languages([
  'zh-Hans'
])
 
# 储存位置
output_directory "./fastlane/screenshots"
 
# 删除之前图片
clear_previous_screenshots true
</code></pre>
</div>

<p>然后打开 Xcode 工程,添加截图设置(需要增加 UI Test, 因为截图是在 UI Test 时截取的):</p>

<div class="highlighter-rouge"><pre class="highlight"><code>\\ 1）在项目添加UI测试,已经添加略过
\\ 2）将./fastlane/SnapshotHelper.swift 添加到UI测试中
\\ 3）打开 AD_DemoUITests.swift ,删除setUp和tearDown方法，然后在其中添加以下代码testExample：
 
  let app = XCUIApplication()
  setupSnapshot(app)
  app.launch()
  
  app.buttons["next"].tap()
  snapshot("01firstPage") // 此处截图
  
  app.buttons["back"].tap()
  snapshot("02secondPage") // 此处截图

</code></pre>
</div>

<p>打开 Fastfile ,并添加如下信息,用于配置截图</p>

<div class="highlighter-rouge"><pre class="highlight"><code>  desc "Take screenshots"
  lane :screenshot do
    snapshot
  end
</code></pre>
</div>

<p>执行 <code class="highlighter-rouge">$ fastlane screenshot</code>, fastlane 会自动调用模拟器,执行测试并生成快照,可能会由于模拟器启动慢而导致时间稍微有点长.</p>

<p>成功截图的提示:</p>

<p><img src="https://ooo.0o0.ooo/2017/02/07/58995745a83cd.png" alt="" /></p>

<h3 id="ipa-">5.创建 IPA 文件</h3>

<p>打开 fastfile,加入如下代码,配置创建 ipa</p>

<div class="highlighter-rouge"><pre class="highlight"><code>desc "Create ipa"
  lane :build do
    increment_build_number
    gym
  end
</code></pre>
</div>

<p>保存并执行如下操作,将自动创建 IPA 包</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ fastlane build
</code></pre>
</div>

<p>如果出现错误: <code class="highlighter-rouge">There does not seem to be a CURRENT_PROJECT_VERSION key set for this project.  Add this key to your target's expert build settings.</code>
<a href="https://developer.apple.com/library/content/qa/qa1827/_index.html">请查阅此处</a></p>

<p>这是一个自动增加构建版本号的设置,需要手动修改.</p>

<h3 id="ipa--itc">6.上传 IPA 文件到 ITC</h3>

<p>打开 Fastfile ,添加如下代码:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>desc "Upload to App Store"
  lane :upload do
    deliver
  end
</code></pre>
</div>

<p>然后执行命令,上传到 ITC :</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ fastlane upload
</code></pre>
</div>

<p>期间,会创建一个 html 形式的预览文件,确认没问题输入 y;</p>

<p>当然最有可能的错误就是网络链接的问题: <code class="highlighter-rouge">Please use diagnostic mode to check connectivity. You need to have outbound access to TCP port 443.</code> 重新配置代理即可.</p>

<h3 id="deliverfile">7.配置 Deliverfile</h3>

<p>其实上传 ITC 最主要的文件是 Deliverfile,配置好 Deliverfile 后,可以删除 metadata 文件夹中的文本配置.最终配置如下图:</p>

<p><img src="https://ooo.0o0.ooo/2017/02/08/589ac0ac8d172.png" alt="" /></p>

<p>以下是主要的配置,更多更详细的<a href="https://github.com/mythkiven/AD_Fastlane/blob/master/AD_Demo/fastlane/Deliverfile">请戳文件</a>,里面有详细的注释,拿来即可使用</p>

<div class="highlighter-rouge"><pre class="highlight"><code>
# 1 app_identifier
app_identifier "com.3code.ADDemo"

# 2 用户名,Apple ID电子邮件地址
username "Apple ID电子邮件地址"  

# 3 支持语言
supportedLanguages = {
  "cmn-Hans" =&gt; "zh-Hans"
}

# 4 app 名称
name({
'zh-Hans' =&gt; "ADDemo"
})

# 5 描述
description({
  'zh-Hans' =&gt; "简体中文版"
})

# 6 提交审核信息
submission_information({    
    export_compliance_encryption_updated: false,
    export_compliance_uses_encryption: false,
    content_rights_contains_third_party_content: false,
    add_id_info_uses_idfa: false
})

# 7 应用审核小组的联系信息 app 审核信息
app_review_information(
  first_name: "name",
  last_name: "name",
  phone_number: "手机号",
  email_address: "email",
  demo_user: "测试账号用户名",
  demo_password: "测试账号密码",
  notes: "noting"
)

# 8 copyright 
copyright "#{Time.now.year} 3code"

# 
</code></pre>
</div>

<h3 id="appstore-">8.提交 AppStore 审核</h3>

<p>继续打开 Fastfile,修改如下代码:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>desc "Upload to App Store and submit for review"
  lane :upload do
    deliver(
      submit_for_review: true
    )
  end
</code></pre>
</div>

<p>然后执行命令,提交审核 :</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ fastlane upload
</code></pre>
</div>

<h3 id="section-5">9.使用一键命令</h3>

<p>添加如下的代码,可以一步搞定所有的操作:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>desc "Provision, take screenshots, build and upload to App Store"
  lane :do_everything do
    provision
    screenshot
    build
    upload
  end
</code></pre>
</div>

<p>对应的命令是:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ fastlane do_everything
</code></pre>
</div>

<ul>
  <li>
    <p>本文只是简单的介绍了 fastlane 的使用,更多的资料还请参考文末的链接</p>
  </li>
  <li>
    <p>如果你对 ITC 不了解,或者很少发布 App ,建议看看官方文档,要知道发布 App 也有<a href="https://developer.apple.com/library/content/documentation/LanguagesUtilities/Conceptual/iTunesConnect_Guide_SCh/Appendices/Properties.html">官方指南哦</a></p>
  </li>
  <li>
    <p>本文是系列文章,后续文章会陆续在这里以及我的<a href="www.3code.info">博客</a>中发布,喜欢请给个✨吧</p>
  </li>
</ul>

<h3 id="section-6">10.参考</h3>

<ul>
  <li><a href="https://fastlane.tools/">官网</a></li>
  <li><a href="https://github.com/fastlane/fastlane">github</a></li>
  <li><a href="https://docs.fastlane.tools/getting-started/ios/setup/">文档</a></li>
</ul>

<p>最后给点小建议:如果遇到错误首选就是查 issues,你遇到的问题,基本前人都遇到过了.我能在2天里快速入门 fastlane 全靠看 issues 😁😁</p>


                </div>
                <div class="read-all">
                    <a  href="/2017/02/07/AD-Fastlane/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2017/01/23/AD-XCTest/">持续集成系列 - 测试: XCTest</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2017-01-23
                    </div>
                    <div class="label-card">
                        <i class="fa fa-user"></i>3行代码
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#CI" title="Category: CI" rel="category">CI</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#XCTest" title="Tag: XCTest" rel="tag">XCTest</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#section" id="markdown-toc-section">测试简述</a>    <ul>
      <li><a href="#itc" id="markdown-toc-itc">自动执行测试,自动构建并分发,自动部署到 ITC</a></li>
      <li><a href="#unit-" id="markdown-toc-unit-">Unit 代表单元测试:</a></li>
    </ul>
  </li>
  <li><a href="#ui" id="markdown-toc-ui">UI自动化测试框架</a></li>
  <li><a href="#ios-" id="markdown-toc-ios-">iOS 自动化测试实践</a></li>
</ul>

<h3 id="section">测试简述</h3>

<h5 id="itc">自动执行测试,自动构建并分发,自动部署到 ITC</h5>

<p>自动化测试 –&gt; 持续部署</p>

<p>在互联网的产品开发时代，产品迭代越来越频繁，“从功能开发完成直到成功部署”这一阶段被称为软件开发“最后一公里”。很多开发团队也越来越认识到，自动化测试和持续部署可帮助开发团队提高迭代效率和质量。
那么，如何更好地解决“最后一公里”这一问题呢?</p>

<p>一切从自动化测试开始，让自动化测试贯穿在整个项目开发-集成-部署-交付的-开发流程中。</p>

<p><img src="http://huaban.com/go/?pin_id=1002439558" alt="" />
在这个分层自动化测试金字塔中，</p>
<h4 id="unit-">Unit 代表单元测试:</h4>

<p>XCTest是苹果在iOS 7和Xcode5引入的一个简单而强大的测试框架，它的测试编写起来非常简单，并且遵循xUnit风格。XCTest的优点是与Xcode深度集成，有专门的Test导航栏，但因为受限于官方测试API，因此功能不是很丰富。</p>

<p>iOS 中的单元测试开源库:</p>
<ul>
  <li>Kiwi是对XCTest的一个完整替代，使用xSpec风格编写测试。Kiwi带有自己的一套工具集，包括expectations、mocks、stubs，甚至还支持异步测试。</li>
  <li>Specta与Kiwi功能相似，但在架构上非常不同。Kiwi注重功能的整合，而Specta则注重模块化。它本身只专注于运行测试，而将模拟、匹配等功能交给第三方。下
下面这些一些开源测试组件，它们能与Specta和Kiwi框架搭配使用：</li>
  <li>Expecta：匹配程序框架。</li>
  <li>OCHamcrest：匹配程序框架。</li>
  <li>OCMock：模拟测试框架。</li>
  <li>OCMockito：模拟测试框架。</li>
  <li>OHTTPStubs：模拟网络请求的库，基于block的语法来匹配URL。</li>
  <li>Nocilla：模拟网络请求的库，使用链式API。</li>
  <li>Quick是:一个使用Swift开发的新测试框架，对测试使用Swift编写的App非常友好。它还有一个Nimble库用于编写匹配模式。</li>
</ul>

<h2 id="ui">UI自动化测试框架</h2>

<p>一些第三方自动化测试框架则比较成熟，如Appium, MonkeyTalk，Frank等，这里介绍KIF和EarlGrey:开源\内嵌式框架 (以 framework 形式内嵌至应用中) , 本质上是iOS的Unit test
\使用Object-C和Swift\支持真机和模拟器</p>

<ul>
  <li>EarlGrey:原生的 iOS UI 自动化测试框架,写法多样,操作灵活,作为后来者的EarlGrey功能更加强大.<a href="https://github.com/google/EarlGrey">github/文档</a></li>
  <li>KIF:出来早\KIF的语法比较简单\适合快速开发.<a href="">github</a><a href="http://cocoadocs.org/docsets/KIF/3.5.1/">文档</a></li>
</ul>

<h1 id="ios-">iOS 自动化测试实践</h1>

<p>###单元测试（Unit Testing）是针对程序单元进行正确性检验的测试工作,程序单元是应用的 最小可测试部件.</p>

<ul>
  <li>Expecta:专为Objective-C/Cocoa而生，相比OCHamcrest，其优化了匹配的语法，测试用例的可读性更高。</li>
  <li>OCHamcrest:</li>
  <li>GHUnit已被弃用，不能积极维护！使用XCTest来代替。</li>
  <li>OCUnit，被官方集成进XCode 4.x版本中；</li>
</ul>

<p>持续集成CI（Continuous Integration）是一种实践,可以让团队在持续的基础上收到反馈并进行改进,不必等到开发周期后期才寻找和修复缺陷.通俗一点儿说:就是指对于开发人员的每一次代码提交,都自动地把Repository中所有代码Check out到一个空目录,并且自动运行所有Test Case.如果成功则接受这次提交,否则告诉所有人,这是一个失败的Revision[2]</p>


                </div>
                <div class="read-all">
                    <a  href="/2017/01/23/AD-XCTest/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2017/01/13/Travis-CI/">持续集成系列 - Github中的魔法工具:Travis CI</a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2017-01-13
                    </div>
                    <div class="label-card">
                        <i class="fa fa-user"></i>3行代码
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#CI" title="Category: CI" rel="category">CI</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#Github" title="Tag: Github" rel="tag">Github</a>&nbsp;
    
        <a href="/tag/#Travis-CI" title="Tag: Travis-CI" rel="tag">Travis-CI</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#jenkins" id="markdown-toc-jenkins">基础知识,参考博文:Jenkins</a></li>
  <li><a href="#travis-ci-" id="markdown-toc-travis-ci-">1. Travis-CI 简介</a>    <ul>
      <li><a href="#jenkins-1" id="markdown-toc-jenkins-1">对比 Jenkins</a></li>
    </ul>
  </li>
  <li><a href="#travis-ci--1" id="markdown-toc-travis-ci--1">2.Travis-CI 配置小教程</a>    <ul>
      <li><a href="#project-" id="markdown-toc-project-">project 项目配置</a></li>
      <li><a href="#workspace-" id="markdown-toc-workspace-">workspace 管理的项目配置</a></li>
    </ul>
  </li>
  <li><a href="#section" id="markdown-toc-section">3. 应用程序的签名\证书</a></li>
  <li><a href="#section-1" id="markdown-toc-section-1">4.部署</a></li>
  <li><a href="#section-2" id="markdown-toc-section-2">密码和证书安全</a></li>
  <li><a href="#section-3" id="markdown-toc-section-3">其他</a>    <ul>
      <li><a href="#section-4" id="markdown-toc-section-4">显示构建状态</a></li>
      <li><a href="#section-5" id="markdown-toc-section-5">跳过自动构建</a></li>
    </ul>
  </li>
  <li><a href="#section-6" id="markdown-toc-section-6">资源</a>    <ul>
      <li><a href="#unit-" id="markdown-toc-unit-">Unit 代表单元测试:</a></li>
    </ul>
  </li>
  <li><a href="#ui-" id="markdown-toc-ui-">UI 测试</a></li>
</ul>

<h3 id="jenkins">基础知识,参考博文:Jenkins</h3>

<h3 id="travis-ci-">1. Travis-CI 简介</h3>

<p>Travis-CI 是一个开源的持续构建项目,能够测试和部署;Travis-CI 会同步你在 GitHub 上托管的项目,每当你 Commit Push 之后,预装的编译脚本会分析你的 Xcode 项目,并对每个 target 进行编译.如果所有文件都没有编译错误,并且测试也没有被打断,那么项目就编译成功了.</p>

<h5 id="jenkins-1">对比 Jenkins</h5>

<ul>
  <li>Jenkins 和 Travis-CI 类似,前者主要用于公司中项目的 CI(商业化),后者则主要用在 GitHub 中(小众)</li>
  <li>都是基于 Vagrant/Virtualbox技术</li>
  <li>配置文件:Jenkins 配置在 Jenkins 服务器中,后者配置文件和源码一起.使用 DSL 编写的</li>
  <li>Travis Ci 与 Github 集成非常紧密,官方的集成测试托管只支持 Github 项目</li>
  <li>总的来说:如果是开源项目,放在 GitHub 上,使用 Travis CI 来做集成测试是最佳选择.但如果是公司项目,当然是搭建 Jenkins 环境.</li>
</ul>

<h3 id="travis-ci--1">2.Travis-CI 配置小教程</h3>

<ul>
  <li>1.用你的 GitHub 账号登录 <a href="https://travis-ci.org/">Travis-CI</a>,赋予 TCI 访问 GH 的授权.</li>
</ul>

<p>对于私有仓库,需要注册一个 <a href="https://magnum.travis-ci.com/">Travis 专业版账号</a></p>

<ul>
  <li>
    <p>2.登录之后 Travis-CI 就会同步 GitHub 账号的仓库,然后打开个人页面并给你想要构建的项目启用 Travis-CI <img src="https://raw.githubusercontent.com/nukc/how-to-use-travis-ci/master/images/enable.png" alt="" /></p>
  </li>
  <li>
    <p>3.创建一个 .travis.yml 文件,在项目的根目录下.则 Travis-CI 会按照 .travis.yml 里的内容进行构建</p>
  </li>
  <li>
    <p>4.最后可以在<a href="https://travis-ci.org/repositories">构建状态页面</a>来查看你的项目是否构建成功</p>
  </li>
</ul>

<h5 id="project-">project 项目配置</h5>

<pre><code class="language-DSL">language: swift # 语言种类
#language: objective-c 

osx_image: xcode8 # 环境

# 根据项目类型不同,可以选择两个 key :xcode_project 或者  xcode_workspace
xcode_project: ./UITEST.xcodeproj # 项目文件相对于.travis.yml文件的路径

xcode_scheme: UITEST # 你需要集成测试的scheme

xcode_sdk: iphonesimulator10.0 # 模拟器

</code></pre>

<h5 id="workspace-">workspace 管理的项目配置</h5>

<pre><code class="language-DSL">language: swift # 语言种类
#language: objective-c 

osx_image: xcode8 # 环境

# 根据项目类型不同,可以选择两个 key :xcode_project 或者  xcode_workspace
xcode_workspace: ./UITEST.xcworkspace # 项目文件相对于.travis.yml文件的路径

xcode_scheme: UITEST # 你需要集成测试的scheme

xcode_sdk: iphonesimulator10.0 # 模拟器

</code></pre>

<p>同时也要设置 Target 为 shared 状态.</p>

<blockquote>
  <p>打开项目 -&gt; Manage Schemes -&gt; 把需要构建的 Target 勾上 shared -&gt; 选中你需要管理的 scheme,点击左下角的 Edit 按钮 -&gt; 选择 Build 选项，点击左下角的+号按钮，添加你需要依赖的 CocoaPods 管理的第三方静态库的名字，下图是已经添加后的截图.</p>
</blockquote>

<p><img src="http://upload-images.jianshu.io/upload_images/656113-97e903b6472ce2eb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="" /></p>

<p>以上配置,可以看看<a href="https://docs.travis-ci.com/user/languages/objective-c/">官方文档</a>,写的挺详细的</p>

<h3 id="section">3. 应用程序的签名\证书</h3>

<p>[参见(https://objccn.io/issue-6-5/)</p>

<h3 id="section-1">4.部署</h3>

<p>负责分发部署的平台很多像:TestFlight \ HockeyApp \ 蒲公英 \ fir.im 等等</p>

<p>可以配置然后在上述平台进行部署.</p>

<h3 id="section-2">密码和证书安全</h3>

<p>对于密码等敏感信息,Travis CI提供了2种解决方案:</p>

<ul>
  <li>对密码等敏感信息进行加密,然后再构建环境时解密</li>
  <li>在 Travis CI控制台设置环境变量,然后使用 System.getenv() 获取值</li>
</ul>

<p><img src="https://raw.githubusercontent.com/nukc/how-to-use-travis-ci/master/images/var-setting.png" alt="" /></p>

<h3 id="section-3">其他</h3>

<h5 id="section-4">显示构建状态</h5>

<p><img src="https://raw.githubusercontent.com/nukc/how-to-use-travis-ci/master/images/image.png" alt="" /></p>

<h5 id="section-5">跳过自动构建</h5>

<p>如果commit不想让travis ci构建，那么就在commit message里加上[ci skip]就行了。</p>

<div class="language-shell highlighter-rouge"><pre class="highlight"><code>git commit -m <span class="s2">"[ci skip] commit message"</span>
</code></pre>
</div>

<h3 id="section-6">资源</h3>

<ul>
  <li><a href="https://docs.travis-ci.com/user/customizing-the-build/">官方文档</a></li>
  <li><a href="https://github.com/objcio/issue-6-travis-ci">示例 Demo</a></li>
  <li><a href="https://github.com/facebook/xctool">xctool</a></li>
  <li><a href="https://github.com/nukc/how-to-use-travis-ci">安卓环境下的教程</a></li>
</ul>

<p>-<a href="https://objccn.io/issue-6-5/">优秀的文章为 iOS 建立 Travis CI:签名+部署+发布</a>
-<a href="http://blog.csdn.net/jiang314/article/details/54965283">备份版:优秀的文章为 iOS 建立 Travis CI:签名+部署+发布</a></p>

<p>为 iOS 建立 Travis CI: https://objccn.io/issue-6-5/</p>

<p>自动化测试 –&gt; 持续部署</p>

<p>在互联网的产品开发时代，产品迭代越来越频繁，“从功能开发完成直到成功部署”这一阶段被称为软件开发“最后一公里”。很多开发团队也越来越认识到，自动化测试和持续部署可帮助开发团队提高迭代效率和质量。
那么，如何更好地解决“最后一公里”这一问题呢?</p>

<p>一切从自动化测试开始，让自动化测试贯穿在整个项目开发-集成-部署-交付的-开发流程中。</p>

<p><img src="http://huaban.com/go/?pin_id=1002439558" alt="" />
在这个分层自动化测试金字塔中，</p>
<h4 id="unit-">Unit 代表单元测试:</h4>

<p>XCTest是苹果在iOS 7和Xcode5引入的一个简单而强大的测试框架，它的测试编写起来非常简单，并且遵循xUnit风格。XCTest的优点是与Xcode深度集成，有专门的Test导航栏，但因为受限于官方测试API，因此功能不是很丰富。</p>

<p>iOS 中的单元测试开源库:</p>
<ul>
  <li>Kiwi是对XCTest的一个完整替代，使用xSpec风格编写测试。Kiwi带有自己的一套工具集，包括expectations、mocks、stubs，甚至还支持异步测试。</li>
  <li>Specta与Kiwi功能相似，但在架构上非常不同。Kiwi注重功能的整合，而Specta则注重模块化。它本身只专注于运行测试，而将模拟、匹配等功能交给第三方。下
下面这些一些开源测试组件，它们能与Specta和Kiwi框架搭配使用：</li>
  <li>Expecta：匹配程序框架。</li>
  <li>OCHamcrest：匹配程序框架。</li>
  <li>OCMock：模拟测试框架。</li>
  <li>OCMockito：模拟测试框架。</li>
  <li>OHTTPStubs：模拟网络请求的库，基于block的语法来匹配URL。</li>
  <li>Nocilla：模拟网络请求的库，使用链式API。</li>
  <li>Quick是:一个使用Swift开发的新测试框架，对测试使用Swift编写的App非常友好。它还有一个Nimble库用于编写匹配模式。</li>
</ul>

<p>对软件中的最小可测试单元进行检验。通常而言，一个单元测试是用于判断某个特定条件（或者场景）下某个特定函数的行为。相比其他层级的测试，单元测试发现并解决问题付出的成本相对来说最低，而投入产出比最高</p>

<h3 id="ui-">UI 测试</h3>

<ul>
  <li>KIF（Keep It Functional）是用Objective-C编写的用户界面测试框架。KIF tester使用了私有API来了解App中的视图层级。缺点是运行较慢。</li>
</ul>

<blockquote>
  <p>相关文章:<a href="http://www.blogs8.cn/posts/A1Rj797">Swift中KIF测试的特点－b</a></p>
</blockquote>

<ul>
  <li>
    <p>Subliminal是另一款与XCTest集成的框架。与KIF不同的是，它基于UIAutomation编写，旨在对开发者隐藏UIAutomation中一些复杂的细节。不过它最后更新日期是2014年2月，可能已停止更新。</p>
  </li>
  <li>
    <p>Calabash是跨平台开发工具Xamarin推出的一款测试工具。它使用BDD风格来编写验收测试。它的优点是支持跨平台（需使用不同的库），声明式的测试风格非常易于读写。缺点是不够稳定并且运行速度慢。</p>
  </li>
</ul>


                </div>
                <div class="read-all">
                    <a  href="/2017/01/13/Travis-CI/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
              <li>
                <h2>
                  <a class="post-link" href="/2017/01/09/AD-iOS-OTA/">持续集成系列 - App 内测分发平台之 OTA </a>
                </h2>
                <div class="label">
                    <div class="label-card">
                        <i class="fa fa-calendar"></i>2017-01-09
                    </div>
                    <div class="label-card">
                        <i class="fa fa-user"></i>3行代码
                        
                    </div>
                    <div class="label-card">
                        
                    </div>

                    <div class="label-card">
                    


<!-- <span class="point">•</span> -->
<span class="categories">
  <i class="fa fa-th-list"></i>
  
    
        <a href="/category/#CI" title="Category: CI" rel="category">CI</a>
    
  

  <!-- <span class="point">•</span> -->
</span>


                    </div>

                    <div class="label-card">
                    
<!-- <span class="point">•</span> -->
<span class="pageTag">
  <i class="fa fa-tags"></i>
  
    
        <a href="/tag/#OTA" title="Tag: OTA" rel="tag">OTA</a>
    
  

</span>

                    </div>
                </div>
                <div class="excerpt">
                    <ul id="markdown-toc">
  <li><a href="#section" id="markdown-toc-section">剩下的任务就是: 如何通过脚本,将项目打包,并上传的服务器??????????</a></li>
  <li><a href="#newitemforgitlab--" id="markdown-toc-newitemforgitlab--">newItemForGitlab 项目已经可以正确的运行了,关键就是 打包编译的问题//////</a>    <ul>
      <li><a href="#section-1" id="markdown-toc-section-1">前言</a></li>
    </ul>
  </li>
</ul>

<h1 id="section">剩下的任务就是: 如何通过脚本,将项目打包,并上传的服务器??????????</h1>
<h1 id="newitemforgitlab--">newItemForGitlab 项目已经可以正确的运行了,关键就是 打包编译的问题//////</h1>

<h3 id="section-1">前言</h3>

<p>目标是:建立自己的移动应用内测分发平台.方便测试人员快速的获取到最新的测试包.</p>

<p>流程:</p>

<ul>
  <li>通过脚本,自动将项目打包编译,生成 AdHoc 版本的 ipa</li>
  <li>脚本自动上传 ipa 到公司内网的服务器</li>
  <li>然后邮件通知相关人员,邮件中内置 url</li>
  <li>在 Safari 中点开url,直接安装内测版本</li>
</ul>

<p><strong>注意事项:必要3条件</strong></p>

<ul>
  <li>
    <ol>
      <li>AdHoc 版 ipa 文件</li>
    </ol>
  </li>
  <li>
    <ol>
      <li>AdHoc 版 plist 文件</li>
    </ol>
  </li>
</ul>

<p>如果是使用 Xcode 打包,会自动生成上述的两个文件,当然也可以使用脚本生成.plist 文件内容如下(小结末尾)</p>

<ul>
  <li>
    <ol>
      <li>一个内测发布页面</li>
    </ol>
  </li>
</ul>

<p>目的是提供一个<code class="highlighter-rouge">itms-services://</code>协议的链接,让用户访问这个链接即可实现在线安装.一个最简单的html页面就是下面这样:</p>

<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"itms-services://?action=download-manifest&amp;url=https://1192.168.117.39/apps/manifest.plist"</span><span class="nt">&gt;</span>
  Download ADDemo
<span class="nt">&lt;/a&gt;</span>
<span class="c">&lt;!-- 或者这样 --&gt;</span>
<span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"itms-services://?action=download-manifest&amp;url=https://xxx.xxx.xxx/xxx.plist"</span><span class="nt">&gt;</span>Install App<span class="nt">&lt;/a&gt;</span>  
</code></pre>
</div>

<p>整个OTA的核心就是苹果的itms-services协议， safari通过解析类似于itms-services://?action=download-manifest&amp;url=https://xxx.xxx.xxx/xxxx.plist 这样的一个链接来实现在线安装。url就是你的*.plist文件所在的地址，在iOS7.1以前，这个url是没有限制的，在7.1之后，苹果做了修改，要求这个url必须是可信任的https链接。其他地方的链接并没有要求。</p>

<p>OTA就是over the air,是一种无线发布方式,它可以实现app的在线安装,不再需要数据线.</p>

<p>而对于 https,方案有:自己公司搭建;使用三方的云盘(hppts的,将 ipa 传上去);自己配置.
更详细的内容参考:<a href="http://blog.csdn.net/close_marty/article/details/38441903">iOS通过OTA方式分发应用的实现</a></p>

<p>相关资料:
1.plist 文件的内容为:</p>
<div class="language-xml highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="cp">&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;</span>
<span class="nt">&lt;plist</span> <span class="na">version=</span><span class="s">"1.0"</span><span class="nt">&gt;</span>
<span class="nt">&lt;dict&gt;</span>
    <span class="nt">&lt;key&gt;</span>items<span class="nt">&lt;/key&gt;</span>
    <span class="nt">&lt;array&gt;</span>
        <span class="nt">&lt;dict&gt;</span>
            <span class="nt">&lt;key&gt;</span>assets<span class="nt">&lt;/key&gt;</span>
            <span class="nt">&lt;array&gt;</span>
                <span class="nt">&lt;dict&gt;</span>
                    <span class="nt">&lt;key&gt;</span>kind<span class="nt">&lt;/key&gt;</span>
                    <span class="nt">&lt;string&gt;</span>software-package<span class="nt">&lt;/string&gt;</span>
                    <span class="nt">&lt;key&gt;</span>url<span class="nt">&lt;/key&gt;</span>
                    <span class="nt">&lt;string&gt;</span>https://192.168.117.39/apps/app.ipa<span class="nt">&lt;/string&gt;</span>
                    <span class="c">&lt;!-- 这里是服务器上的 ipa 的地址--&gt;</span>
                <span class="nt">&lt;/dict&gt;</span>
                <span class="nt">&lt;dict&gt;</span>
                    <span class="nt">&lt;key&gt;</span>kind<span class="nt">&lt;/key&gt;</span>
                    <span class="nt">&lt;string&gt;</span>display-image<span class="nt">&lt;/string&gt;</span>
                    <span class="nt">&lt;key&gt;</span>url<span class="nt">&lt;/key&gt;</span>
                    <span class="nt">&lt;string&gt;</span>https://avatar.csdn.net/F/2/A/1_close_marty.jpg<span class="nt">&lt;/string&gt;</span>
                     <span class="c">&lt;!-- 这是展示图片--&gt;</span>
                <span class="nt">&lt;/dict&gt;</span>
                <span class="nt">&lt;dict&gt;</span>
                    <span class="nt">&lt;key&gt;</span>kind<span class="nt">&lt;/key&gt;</span>
                    <span class="nt">&lt;string&gt;</span>full-size-image<span class="nt">&lt;/string&gt;</span>
                    <span class="nt">&lt;key&gt;</span>url<span class="nt">&lt;/key&gt;</span>
                    <span class="nt">&lt;string&gt;</span>https://avatar.csdn.net/F/2/A/1_close_marty.jpg<span class="nt">&lt;/string&gt;</span>
                     <span class="c">&lt;!-- 这是展示图片--&gt;</span>
                <span class="nt">&lt;/dict&gt;</span>
            <span class="nt">&lt;/array&gt;</span>
            <span class="nt">&lt;key&gt;</span>metadata<span class="nt">&lt;/key&gt;</span>
            <span class="c">&lt;!-- 如果是放在服务器上,以下的 内容要写成动态的 --&gt;</span>
            <span class="nt">&lt;dict&gt;</span>
                <span class="nt">&lt;key&gt;</span>bundle-identifier<span class="nt">&lt;/key&gt;</span>
                <span class="nt">&lt;string&gt;</span>${BUNDLE_IDENTIFIER}<span class="nt">&lt;/string&gt;</span>  
                <span class="c">&lt;!-- &lt;string&gt;com.3code.ADDemo&lt;/string&gt; --&gt;</span>
                <span class="nt">&lt;key&gt;</span>bundle-version<span class="nt">&lt;/key&gt;</span>
                <span class="nt">&lt;string&gt;</span>${APPLICATION_VERSION}<span class="nt">&lt;/string&gt;</span>  
                <span class="c">&lt;!-- &lt;string&gt;1.0&lt;/string&gt; --&gt;</span>
                <span class="nt">&lt;key&gt;</span>kind<span class="nt">&lt;/key&gt;</span>
                <span class="nt">&lt;string&gt;</span>software<span class="nt">&lt;/string&gt;</span>
                <span class="nt">&lt;key&gt;</span>title<span class="nt">&lt;/key&gt;</span>
                <span class="nt">&lt;string&gt;</span>${DISPLAY_NAME}<span class="nt">&lt;/string&gt;</span>  
                <span class="c">&lt;!-- &lt;string&gt;AD_Demo&lt;/string&gt; --&gt;</span>
            <span class="nt">&lt;/dict&gt;</span>
        <span class="nt">&lt;/dict&gt;</span>
    <span class="nt">&lt;/array&gt;</span>
<span class="nt">&lt;/dict&gt;</span>
<span class="nt">&lt;/plist&gt;</span>
</code></pre>
</div>

<ol>
  <li>web 页面的参考代码:</li>
</ol>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
<span class="nt">&lt;head&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">"Content-Type"</span> <span class="na">content=</span><span class="s">"text/html; charset=iso-8859-1"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"</span> <span class="nt">/&gt;</span> 
  <span class="nt">&lt;title&gt;</span>Install Geoloqi<span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;style </span><span class="na">type=</span><span class="s">"text/css"</span><span class="nt">&gt;</span>
    <span class="nt">body</span> <span class="p">{</span>
      <span class="nl">background</span><span class="p">:</span> <span class="sx">url(bkg.png)</span> <span class="nb">repeat</span> <span class="m">#c5ccd4</span><span class="p">;</span>
      <span class="nl">font-family</span><span class="p">:</span> <span class="n">Helvetica</span><span class="p">,</span> <span class="n">arial</span><span class="p">,</span> <span class="nb">sans-serif</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nc">.congrats</span> <span class="p">{</span>
      <span class="nl">font-size</span><span class="p">:</span> <span class="m">16pt</span><span class="p">;</span>
      <span class="nl">padding</span><span class="p">:</span> <span class="m">6px</span><span class="p">;</span>
      <span class="nl">text-align</span><span class="p">:</span> <span class="nb">center</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nc">.step</span> <span class="p">{</span>
      <span class="nl">background</span><span class="p">:</span> <span class="no">white</span><span class="p">;</span>
      <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="m">#ccc</span> <span class="nb">solid</span><span class="p">;</span>
      <span class="nl">border-radius</span><span class="p">:</span> <span class="m">14px</span><span class="p">;</span>
      <span class="nl">padding</span><span class="p">:</span> <span class="m">4px</span> <span class="m">10px</span><span class="p">;</span>
      <span class="nl">margin</span><span class="p">:</span> <span class="m">10px</span> <span class="m">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nc">.instructions</span> <span class="p">{</span>
      <span class="nl">font-size</span><span class="p">:</span> <span class="m">10pt</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nc">.arrow</span> <span class="p">{</span>
      <span class="nl">font-size</span><span class="p">:</span> <span class="m">15pt</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nt">table</span> <span class="p">{</span>
      <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"congrats"</span><span class="nt">&gt;</span>Congrats! You've been invited to the beta of Geoloqi.<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"step"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;table&gt;&lt;tr&gt;</span>
    <span class="nt">&lt;td</span> <span class="na">class=</span><span class="s">"instructions"</span><span class="nt">&gt;</span>Install the<span class="nt">&lt;br</span> <span class="nt">/&gt;</span>Geoloqi app<span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td</span> <span class="na">width=</span><span class="s">"24"</span> <span class="na">class=</span><span class="s">"arrow"</span><span class="nt">&gt;</span><span class="ni">&amp;rarr;</span><span class="nt">&lt;/td&gt;</span>
    <span class="nt">&lt;td</span> <span class="na">width=</span><span class="s">"57"</span> <span class="na">class=</span><span class="s">"imagelink"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"itms-services://?action=download-manifest&amp;url=http://loqi.me/app/Geoloqi.plist"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"geoloqi-icon.png"</span> <span class="na">height=</span><span class="s">"57"</span> <span class="na">width=</span><span class="s">"57"</span> <span class="nt">/&gt;</span>
      <span class="nt">&lt;/a&gt;</span>
    <span class="nt">&lt;/td&gt;</span>
  <span class="nt">&lt;/tr&gt;&lt;/table&gt;</span>
<span class="nt">&lt;/div&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
</div>

<p>3.证书的配置,<a href="http://blog.csdn.net/close_marty/article/details/38441903">参见</a></p>


                </div>
                <div class="read-all">
                    <a  href="/2017/01/09/AD-iOS-OTA/"><i class="fa fa-newspaper-o"></i>Read All</a>
                </div>
                <hr>
              </li>
            
        </ul>



        <!-- Pagination links -->
        <div class="pagination">
          
            <span class="previous disable"><i class="fa fa-angle-double-left"></i></span>
            <span class="previous disable"><i class="fa fa-angle-left"></i></span>
          
          <span class="page_number ">1/7</span>
          
            <a href="/page2" class="next"><i class="fa fa-angle-right"></i></a>
            <a href="/page7" class="next"><i class="fa fa-angle-double-right"></i></a>
          
        </div>
    </div>
    <!-- <button class="anchor"><i class="fa fa-anchor"></i></button> -->
    <div class="right">
        <div class="wrap">
            <div class="side">
                <div>
                    <i class="fa fa-pencil-square-o" aria-hidden="true"></i>
                    最新文章
                </div>
                <ul class="content-ul" recent>
                    
                        <li><a href="/2017/02/08/AD-jenkins/"> 持续集成系列 - CI + Jenkins的魔法世界</a></li>
                    
                        <li><a href="/2017/02/08/AD-jenkins/">Ad Jenkins</a></li>
                    
                        <li><a href="/2017/02/07/AD-Fastlane/"> 持续集成系列 - Fastlane的黑魔法:自动打包编译上传 AppStore</a></li>
                    
                        <li><a href="/2017/01/23/AD-XCTest/">持续集成系列 - 测试: XCTest</a></li>
                    
                        <li><a href="/2017/01/13/Travis-CI/">持续集成系列 - Github中的魔法工具:Travis CI</a></li>
                    
                        <li><a href="/2017/01/09/AD-iOS-OTA/">持续集成系列 - App 内测分发平台之 OTA </a></li>
                    
                        <li><a href="/2017/01/08/SDiffuseMenu/">Swift 版 AwesomeMenu 的改写之旅:SDiffuseMenu</a></li>
                    
                        <li><a href="/2016/12/11/swift_X_Initialization_Deinitialization/">Swift3.0_X_构造过程和析构过程 </a></li>
                    
                        <li><a href="/2016/12/10/swift_IX_Methods_Subscripts_Inheritance/">Swift3.0_IX_方法、下标和继承 </a></li>
                    
                        <li><a href="/2016/12/08/swift_VIII_Enumerations_Classes_Structures_Properties/">Swift3.0_VIII_枚举、类、结构体、属性</a></li>
                    
                </ul>
            </div>

            <!-- Content -->
            <div class="side ">
                <div>
                    <i class="fa fa-th-list"></i>
                    分类
                </div>
                <ul class="content-ul" cate>
                    
                    <li>
                        <a href="/category/#OS_X" class="categories-list-item" cate="OS_X">
                            <span class="name">
                                OS_X
                            </span>
                            <span class="badge">2</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Objective-C" class="categories-list-item" cate="Objective-C">
                            <span class="name">
                                Objective-C
                            </span>
                            <span class="badge">5</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Reverse" class="categories-list-item" cate="Reverse">
                            <span class="name">
                                Reverse
                            </span>
                            <span class="badge">9</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#AD" class="categories-list-item" cate="AD">
                            <span class="name">
                                AD
                            </span>
                            <span class="badge">4</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#tips" class="categories-list-item" cate="tips">
                            <span class="name">
                                tips
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#python" class="categories-list-item" cate="python">
                            <span class="name">
                                python
                            </span>
                            <span class="badge">1</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#Swift3.0" class="categories-list-item" cate="Swift3.0">
                            <span class="name">
                                Swift3.0
                            </span>
                            <span class="badge">11</span>
                        </a>
                    </li>
                    
                    <li>
                        <a href="/category/#CI" class="categories-list-item" cate="CI">
                            <span class="name">
                                CI
                            </span>
                            <span class="badge">5</span>
                        </a>
                    </li>
                    
                </ul>
            </div>
            <!-- 其他div框放到这里 -->
            <div class="side">
                <div>
                    <i class="fa fa-tags"></i>
                    Tags
                </div>
                <div class="tags-cloud">
                    
                    
                    
                    

                    

                    
                      
                      
                      
                      
                      
                      <a href="/tag/#apache" style="font-size: 9pt; color: #999;">apache</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#WKWebView、Native与JS、缓存、NSURLProtocol" style="font-size: 9pt; color: #999;">WKWebView、Native与JS、缓存、NSURLProtocol</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Charles" style="font-size: 9pt; color: #999;">Charles</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Reveal" style="font-size: 9pt; color: #999;">Reveal</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#iOSOpenDev" style="font-size: 9pt; color: #999;">iOSOpenDev</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#block" style="font-size: 9pt; color: #999;">block</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#NSURLProtocol" style="font-size: 9pt; color: #999;">NSURLProtocol</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#缓存" style="font-size: 10pt; color: #888;">缓存</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#NSURLCache" style="font-size: 9pt; color: #999;">NSURLCache</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#SecureCRT" style="font-size: 9pt; color: #999;">SecureCRT</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#博客" style="font-size: 9pt; color: #999;">博客</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#jekyll" style="font-size: 9pt; color: #999;">jekyll</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#sublime" style="font-size: 9pt; color: #999;">sublime</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#环境变量" style="font-size: 9pt; color: #999;">环境变量</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#mac_tips" style="font-size: 9pt; color: #999;">mac_tips</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Sublime" style="font-size: 10pt; color: #888;">Sublime</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#iOS逆向" style="font-size: 9pt; color: #999;">iOS逆向</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#class_dump" style="font-size: 9pt; color: #999;">class_dump</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Theos" style="font-size: 10pt; color: #888;">Theos</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Logos" style="font-size: 9pt; color: #999;">Logos</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#iOS基础" style="font-size: 9pt; color: #999;">iOS基础</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#IDA、iFunBox、dyld_decache" style="font-size: 9pt; color: #999;">IDA、iFunBox、dyld_decache</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#iOS逆向工具集" style="font-size: 9pt; color: #999;">iOS逆向工具集</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#iOS逆向理论基础" style="font-size: 9pt; color: #999;">iOS逆向理论基础</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#脚本" style="font-size: 9pt; color: #999;">脚本</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#python" style="font-size: 9pt; color: #999;">python</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Swift3.0" style="font-size: 18pt; color: #000;">Swift3.0</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#SDiffuseMenu" style="font-size: 9pt; color: #999;">SDiffuseMenu</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Animation" style="font-size: 9pt; color: #999;">Animation</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#OTA" style="font-size: 9pt; color: #999;">OTA</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Github" style="font-size: 9pt; color: #999;">Github</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#Travis-CI" style="font-size: 9pt; color: #999;">Travis-CI</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#XCTest" style="font-size: 9pt; color: #999;">XCTest</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#fastlane" style="font-size: 10pt; color: #888;">fastlane</a>
                    
                      
                      
                      
                      
                      
                      <a href="/tag/#CI" style="font-size: 9pt; color: #999;">CI</a>
                    
                </div>
            </div>

            <!-- <div class="side">
                <div>
                    <i class="fa fa-external-link"></i>
                    Links
                </div>
                <ul  class="content-ul">

                </ul>
            </div> -->
        </div>
    </div>
</div>
<!-- <script src="/js/scroll.min.js " charset="utf-8"></script> -->
<!-- <script src="/js/pageContent.js " charset="utf-8"></script> -->


    <footer class="site-footer">


    <div class="wrapper">

        <p class="description">
             3行代码的技术博客 
        </p>
        <p class="contact">
            Contact me at:  
            <a href="mailto:mythziven@gmail.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>   -->
<!--            <a href="mailto:mythziven@gmail.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>-->
<!--            <a href="mailto:mythziven@gmail.com" title="email"><i class="fa fa-envelope-o" aria-hidden="true"></i></a>        -->


        </p>
        <p>
            本站总访问量<span id="busuanzi_value_site_pv"></span>次，本站访客数<span id="busuanzi_value_site_uv"></span>人次，本文总阅读量<span id="busuanzi_value_page_pv"></span>次
        </p>
        <p class="power">
        
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>

          <!--   <span>
                Theme designed by <a href="https://github.com/mythkiven">MyKiven</a>.
            </span> -->

        </p>
    </div>
</footer>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    <div class="back-to-top">
    <a href="#top" class="scroll">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </a>
</div>

    <script src=" /js/main.js " charset="utf-8"></script>
    <script src=" /js/scroll.min.js " charset="utf-8"></script>
  </body>

</html>
